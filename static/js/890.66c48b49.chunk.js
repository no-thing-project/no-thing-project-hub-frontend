"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[890],{6890:(e,o,r)=>{r.r(o),r.d(o,{default:()=>j});var s=r(5043),n=r(9412),t=r(4490),a=r(1596),i=r(7353),d=r(4496),l=r(7784),c=r(1787),u=r(7392),p=r(1906),h=r(794),x=r(7254),w=r(3632),g=r(3559),m=r(6213),f=r(1675),v=r(3488),A=r(6552),b=r(579);const j=e=>{let{theme:o,onLogin:r}=e;const[j,k]=(0,s.useState)(""),[y,P]=(0,s.useState)(""),[C,S]=(0,s.useState)(""),[R,_]=(0,s.useState)(""),[L,I]=(0,s.useState)(""),[U,q]=(0,s.useState)(!1),[z,W]=(0,s.useState)(!1),[E,H]=(0,s.useState)(!1),T=(0,f.Zp)();(0,s.useEffect)((()=>{try{const e=new URLSearchParams(window.location.search),o=new URLSearchParams(window.location.hash.split("?")[1]||""),r=e.get("token")||o.get("token");r?(S(r),console.log("Token extracted from URL:",r)):(_("No reset token found in the URL. Please check the link or request a new one."),console.error("No token found in URL"))}catch(e){_("Invalid URL format. Please check the link or request a new one."),console.error("Error parsing URL:",e)}}),[]);const B=()=>{_(""),I("")};return(0,s.useEffect)((()=>{if(L){const e=setTimeout((()=>T("/home")),3e3);return()=>clearTimeout(e)}}),[L,T]),(0,b.jsxs)(n.A,{theme:o,children:[(0,b.jsx)(t.A,{maxWidth:"sm",sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsxs)(a.A,{elevation:6,sx:{p:o.spacing(5),borderRadius:o.shape.borderRadiusMedium,backgroundColor:"background.paper",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:o.custom.loginPaperMaxWidth,textAlign:"center"},children:[(0,b.jsxs)(i.A,{sx:{textAlign:"center",mb:o.spacing(3)},children:[(0,b.jsx)(d.A,{variant:"h4",sx:{color:"text.primary",fontWeight:600},children:"Create Password"}),(0,b.jsx)(d.A,{variant:"body1",sx:{color:"text.secondary",mt:o.spacing(1)},children:"Start your journey from here"})]}),(0,b.jsxs)(i.A,{component:"form",onSubmit:async e=>{e.preventDefault(),_(""),I(""),H(!0);const o=j?/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&]{8,}$/.test(j)?j.length>128?"Password cannot exceed 128 characters":j!==y?"Passwords do not match":C?null:"Reset token is missing":"Password must contain at least 8 characters, uppercase, lowercase, and a number":"New password is required";if(o)return _(o),void H(!1);try{console.log("Sending reset password request with:",{token:C,newPassword:j});const e=await m.A.post(`${v.A.REACT_APP_HUB_API_URL}/api/v1/auth/set-password`,{token:C,newPassword:j});console.log("Response from server:",e.data);const{token:o,profile:s}=e.data;if(!o||!s)throw new Error("Invalid reset password response: Missing token or profile");r(o,s),localStorage.setItem("token",o),I("Password successfully changed! Logging you in...")}catch(c){var s,n,t,a,i,d,l;console.error("Error during reset password:",(null===(s=c.response)||void 0===s?void 0:s.data)||c);const e=400===(null===(n=c.response)||void 0===n?void 0:n.status)?"Invalid or expired reset token. Please request a new one.":(null===(t=c.response)||void 0===t||null===(a=t.data)||void 0===a||null===(i=a.errors)||void 0===i?void 0:i[0])||(null===(d=c.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||"Network error, please try again";_(e),H(!1)}},noValidate:!0,sx:{mt:o.spacing(2),textAlign:"left"},"aria-label":"Reset password form",children:[(0,b.jsx)(l.A,{label:"New Password",type:U?"text":"password",fullWidth:!0,margin:"normal",value:j,onChange:e=>k(e.target.value),InputProps:{endAdornment:(0,b.jsx)(c.A,{position:"end",children:(0,b.jsx)(u.A,{onClick:()=>q(!U),edge:"end","aria-label":U?"Hide new password":"Show new password",sx:{color:"text.primary"},children:U?(0,b.jsx)(w.A,{}):(0,b.jsx)(g.A,{})})})},required:!0,error:!!R&&R.includes("password"),"aria-describedby":R&&R.includes("password")?"new-password-error":void 0,sx:A.z9}),(0,b.jsx)(l.A,{label:"Confirm Password",type:z?"text":"password",fullWidth:!0,margin:"normal",value:y,onChange:e=>P(e.target.value),InputProps:{endAdornment:(0,b.jsx)(c.A,{position:"end",children:(0,b.jsx)(u.A,{onClick:()=>W(!z),edge:"end","aria-label":z?"Hide confirm password":"Show confirm password",sx:{color:"text.primary"},children:z?(0,b.jsx)(w.A,{}):(0,b.jsx)(g.A,{})})})},required:!0,error:!!R&&R.includes("Passwords do not match"),"aria-describedby":R&&R.includes("Passwords do not match")?"confirm-password-error":void 0,sx:A.z9}),(0,b.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",mt:o.spacing(3),gap:o.spacing(3),alignItems:"center"},children:[(0,b.jsx)(p.A,{type:"submit",variant:"contained",disabled:E,fullWidth:!0,sx:A.nT,"aria-label":"Change password",children:E?"Changing Password...":"Change Password"}),(0,b.jsx)(p.A,{variant:"text",onClick:()=>T("/login",{replace:!0}),sx:{color:"text.primary",textTransform:"none",fontSize:"16px",padding:"8px 20px",borderRadius:"20px","&:hover":{textDecoration:"underline"}},"aria-label":"Back to login",children:"Back to Login"})]})]})]})}),(0,b.jsx)(h.A,{open:Boolean(R),autoHideDuration:3e3,onClose:B,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,b.jsx)(x.A,{onClose:B,severity:"error",sx:{width:"100%"},role:"alert",children:R})}),(0,b.jsx)(h.A,{open:Boolean(L),autoHideDuration:3e3,onClose:B,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,b.jsx)(x.A,{onClose:B,severity:"success",sx:{width:"100%"},role:"alert",children:L})})]})}}}]);
//# sourceMappingURL=890.66c48b49.chunk.js.map