"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[897],{2897:(e,a,s)=>{s.r(a),s.d(a,{default:()=>L});var l=s(5043),t=s(1675),i=s(9662),r=s(579);const o=(0,i.A)((0,r.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var n=s(3637),d=s(1007),c=s(5155),u=s(1407),m=s(9320),v=s(141),b=s(3536),g=s(2958),f=s(3769),p=s(9020),h=s(5701),C=s(8800),y=s(3807),_=s(342),M=s(1067),k=s(3801),x=s(4074),w=s(3835),A=s(1654),F=s(4205),I=s(6411),E=s(2334);const j=e=>{let{children:a}=e;const[s,t]=(0,l.useState)(!1);(0,l.useCallback)(((e,a)=>{console.error("ErrorBoundary caught:",e,a),t(!0)}),[]);return s?(0,r.jsx)("div",{children:"Something went wrong. Please try again later."}):a},S=()=>{var e,a;const s=(0,t.Zp)(),i=(0,t.zy)(),{class_id:S}=(0,t.g)(),{showNotification:L}=(0,A.hN)(),{token:D,authData:B,handleLogout:O,isAuthenticated:$,loading:R}=(0,_.A)(),{classItem:T,members:U,stats:N,classes:Q,fetchClass:q,fetchClassMembersList:P,updateExistingClass:G,deleteExistingClass:H,addMemberToClass:K,removeMemberFromClass:z,updateMemberRole:W,toggleFavoriteClass:Z,loading:J,error:V}=(0,M.g)(D,O,s,!0),{boards:X,pagination:Y,fetchBoardsByClass:ee,createNewBoard:ae,updateExistingBoard:se,deleteExistingBoard:le,addMemberToBoard:te,removeMemberFromBoard:ie,updateMemberRole:re,toggleFavoriteBoard:oe,loading:ne,error:de}=(0,k.b)(D,O,s,!0),{gates:ce,fetchGatesList:ue,loading:me,error:ve}=(0,x.c)(D,O,s,!0),[be,ge]=(0,l.useState)(!1),[fe,pe]=(0,l.useState)(!1),[he,Ce]=(0,l.useState)(!1),[ye,_e]=(0,l.useState)(!1),[Me,ke]=(0,l.useState)(!1),[xe,we]=(0,l.useState)(!1),[Ae,Fe]=(0,l.useState)(!1),[Ie,Ee]=(0,l.useState)(null),[je,Se]=(0,l.useState)(null),[Le,De]=(0,l.useState)(null),[Be,Oe]=(0,l.useState)(null),[$e,Re]=(0,l.useState)({...I.pI,class_id:S}),[Te,Ue]=(0,l.useState)("all"),[Ne,Qe]=(0,l.useState)(""),qe=(0,l.useRef)(),Pe=(0,l.useCallback)((e=>{!ne&&Y.hasMore&&(qe.current&&qe.current.disconnect(),qe.current=new IntersectionObserver((e=>{if(e[0].isIntersecting&&Y.hasMore){const e=new AbortController;return ee(S,{visibility:"all"===Te?void 0:Te,page:Y.page+1},e.signal,!0,(e=>{e&&"AbortError"!==e.name&&L(e.message||"Failed to load more boards","error")})),()=>e.abort()}})),e&&qe.current.observe(e))}),[ne,Y.hasMore,Y.page,Te,S,ee,L]),Ge=(0,l.useMemo)((()=>(0,b.debounce)((e=>Qe(e)),300)),[]),He=(0,l.useMemo)((()=>[e=>q(S,e,(e=>{e&&"AbortError"!==e.name&&L(e.message||"Failed to fetch class","error")})),e=>P(S,e,(e=>{e&&"AbortError"!==e.name&&L(e.message||"Failed to fetch class members","error")})),e=>ee(S,{page:1,limit:Y.limit},e,!1,(e=>{e&&"AbortError"!==e.name&&L(e.message||"Failed to fetch boards","error")})),e=>ue({visibility:"public"},e,!1,(e=>{e&&"AbortError"!==e.name&&L(e.message||"Failed to fetch gates","error")}))]),[q,P,ee,ue,S,Y.limit,L]),{isLoading:Ke,actionLoading:ze,setActionLoading:We}=(0,w.t)(He,D,O,s,"class");(0,l.useEffect)((()=>{null!==S&&void 0!==S&&S.trim()||(L("Invalid class ID","error"),s("/classes"))}),[S,s,L]),(0,l.useEffect)((()=>{[V,de,ve].filter(Boolean).forEach((e=>{e&&"canceled"!==e&&L(e,"error")}))}),[V,de,ve,L]),(0,l.useEffect)((()=>{!Ie&&Me&&ke(!1),!je&&fe&&pe(!1)}),[Ie,Me,je,fe]);const Ze=(0,l.useMemo)((()=>(0,F.w)(X||[],"boards",Te,Ne,ce||[],Q||[],[{class_id:S}])),[X,Q,ce,Te,Ne,S]),Je=(0,l.useMemo)((()=>{var e;return(null===U||void 0===U||null===(e=U.find((e=>e.anonymous_id===(null===B||void 0===B?void 0:B.anonymous_id))))||void 0===e?void 0:e.role)||"none"}),[U,B]),Ve=(0,l.useMemo)((()=>ce.find((e=>e.gate_id===(null===T||void 0===T?void 0:T.gate_id)))||null),[ce,T]),Xe=(null===T||void 0===T?void 0:T.creator_id)===(null===B||void 0===B?void 0:B.anonymous_id),Ye=Xe||"admin"===Je,ea=Xe,aa=(null===T||void 0===T||null===(e=T.access)||void 0===e?void 0:e.is_public)||"viewer"!==Je,sa=(0,l.useCallback)((()=>ge(!0)),[]),la=(0,l.useCallback)((()=>{ge(!1),Re({...I.pI,class_id:S})}),[S]),ta=(0,l.useCallback)((async()=>{var e;if(null!==(e=$e.name)&&void 0!==e&&e.trim()){We(!0);try{const e=await ae({...$e,class_id:S});ge(!1),Re({...I.pI,class_id:S}),L("Board created successfully!","success"),s(`/board/${e.board_id}`)}catch(a){L(a.message||"Failed to create board","error")}finally{We(!1)}}else L("Board name is required!","error")}),[$e,ae,S,s,L,We]),ia=(0,l.useCallback)((async()=>{var e;if(null!==je&&void 0!==je&&null!==(e=je.name)&&void 0!==e&&e.trim()){We(!0);try{await se(je.board_id,je),pe(!1),Se(null),L("Board updated successfully!","success")}catch(a){L(a.message||"Failed to update board","error")}finally{We(!1)}}else L("Board name is required!","error")}),[je,se,L,We]),ra=(0,l.useCallback)((async()=>{if(Le){We(!0);try{await le(Le),Ce(!1),De(null),L("Board deleted successfully!","success")}catch(e){L(e.message||"Failed to delete board","error")}finally{We(!1)}}}),[Le,le,L,We]),oa=(0,l.useCallback)((async()=>{var e;if(null!==Ie&&void 0!==Ie&&null!==(e=Ie.name)&&void 0!==e&&e.trim()){We(!0);try{await G(Ie.class_id,Ie),ke(!1),Ee(null),L("Class updated successfully!","success")}catch(a){L(a.message||"Failed to update class","error")}finally{We(!1)}}else L("Class name is required!","error")}),[Ie,G,L,We]),na=(0,l.useCallback)((async()=>{We(!0);try{await H(S),we(!1),L("Class deleted successfully!","success"),s("/classes")}catch(e){L(e.message||"Failed to delete class","error")}finally{We(!1)}}),[S,H,s,L,We]),da=(0,l.useCallback)((async()=>{We(!0);try{await Z(S,null===T||void 0===T?void 0:T.is_favorited),L(null!==T&&void 0!==T&&T.is_favorited?"Class removed from favorites!":"Class added to favorites!","success")}catch(e){L(e.message||"Failed to toggle favorite","error")}finally{We(!1)}}),[S,T,Z,L,We]),ca=(0,l.useCallback)((async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];We(!0);try{var l,t;const i=s?X.find((a=>a.board_id===e)):{members:U,settings:null===T||void 0===T?void 0:T.settings};if((null===i||void 0===i||null===(l=i.members)||void 0===l?void 0:l.length)>=(null===i||void 0===i||null===(t=i.settings)||void 0===t?void 0:t.max_members))return void L("Maximum member limit reached!","error");await(s?te:K)(e,a),L("Member added successfully!","success")}catch(i){L(i.message||"Failed to add member","error")}finally{We(!1)}}),[te,K,X,U,T,L,We]),ua=(0,l.useCallback)((async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];We(!0);try{await(s?ie:z)(e,a),L("Member removed successfully!","success")}catch(l){L(l.message||"Failed to remove member","error")}finally{We(!1)}}),[ie,z,L,We]),ma=(0,l.useCallback)((async function(e,a,s){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];We(!0);try{await(l?re:W)(e,a,s),L("Member role updated successfully!","success")}catch(t){L(t.message||"Failed to update member role","error")}finally{We(!1)}}),[re,W,L,We]),va=(0,l.useCallback)((()=>{Fe(!0)}),[]),ba=(0,l.useCallback)((e=>{Oe(e),_e(!0)}),[]),ga=(0,l.useCallback)((function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(_e(!1),Oe(null)):Fe(!1),L("Members updated successfully!","success")}),[L]),fa=(0,l.useCallback)((()=>{_e(!1),Oe(null)}),[]),pa=(0,l.useCallback)((()=>{Fe(!1)}),[]),ha=(0,l.useCallback)((()=>{Ue("all"),Qe(""),Ge.cancel();const e=new AbortController;return ee(S,{page:1,reset:{visibility:!0}},e.signal,!1,(e=>{e&&"AbortError"!==e.name&&L(e.message||"Failed to reset filters","error")})),()=>e.abort()}),[Ge,ee,S,L]),Ca=(0,l.useMemo)((()=>{var e,a,l,t,i,b;return{type:"class",title:(null===T||void 0===T?void 0:T.name)||"Untitled Class",titleAriaLabel:`Class name: ${(null===T||void 0===T?void 0:T.name)||"Untitled Class"}`,description:(null===T||void 0===T?void 0:T.description)||"No description provided",descriptionAriaLabel:null!==T&&void 0!==T&&T.description?`Class description: ${T.description}`:void 0,chips:[{label:(null===Ve||void 0===Ve?void 0:Ve.name)||"No Gate",icon:(0,r.jsx)(o,{}),color:"secondary",ariaLabel:`Gate: ${(null===Ve||void 0===Ve?void 0:Ve.name)||"No Gate"}`,onClick:null!==Ve&&void 0!==Ve&&Ve.gate_id?()=>s(`/gate/${Ve.gate_id}`):void 0},{label:null!==T&&void 0!==T&&null!==(e=T.access)&&void 0!==e&&e.is_public?"Public":"Private",icon:null!==T&&void 0!==T&&null!==(a=T.access)&&void 0!==a&&a.is_public?(0,r.jsx)(n.A,{}):(0,r.jsx)(d.A,{}),color:null!==T&&void 0!==T&&null!==(l=T.access)&&void 0!==l&&l.is_public?"success":"default",ariaLabel:null!==T&&void 0!==T&&null!==(t=T.access)&&void 0!==t&&t.is_public?"Public class":"Private class"},{label:`Members: ${(null===N||void 0===N?void 0:N.member_count)||(null===U||void 0===U?void 0:U.length)||0}`,icon:(0,r.jsx)(c.A,{}),color:"primary",ariaLabel:`Members: ${(null===N||void 0===N?void 0:N.member_count)||(null===U||void 0===U?void 0:U.length)||0}`},{label:`Boards: ${(null===Ze||void 0===Ze?void 0:Ze.length)||0}`,icon:(0,r.jsx)(u.A,{}),color:"info",ariaLabel:`Boards: ${(null===Ze||void 0===Ze?void 0:Ze.length)||0}`},{label:`Favorites: ${(null===N||void 0===N?void 0:N.favorite_count)||0}`,icon:(0,r.jsx)(m.A,{}),color:"warning",ariaLabel:`Favorites: ${(null===N||void 0===N?void 0:N.favorite_count)||0}`},{label:`Owner: ${(null===T||void 0===T||null===(i=T.creator)||void 0===i?void 0:i.username)||"Unknown"}`,ariaLabel:`Owner: ${(null===T||void 0===T||null===(b=T.creator)||void 0===b?void 0:b.username)||"Unknown"}`}],actions:[{label:"Create Board",icon:(0,r.jsx)(v.A,{}),onClick:sa,tooltip:"Create a new board within this class",disabled:ze||J||ne||!aa,ariaLabel:"Create a new board"},{label:"Edit Class",onClick:()=>{var e,a;T?(Ee({class_id:T.class_id,name:T.name||"",description:T.description||"",is_public:(null===(e=T.access)||void 0===e?void 0:e.is_public)||!1,visibility:null!==(a=T.access)&&void 0!==a&&a.is_public?"public":"private",gate_id:T.gate_id||"",settings:T.settings||{max_boards:100,max_members:50,board_creation_cost:50,tweet_cost:1,allow_invites:!0,require_approval:!1,ai_moderation_enabled:!0,auto_archive_after:30},tags:T.tags||[]}),ke(!0)):L("Class data is not available","error")},tooltip:"Edit class details and settings",disabled:ze||!Ye||Ke,ariaLabel:"Edit class",isMenuItem:!0},{label:"Manage Members",onClick:va,tooltip:"Manage class members",disabled:ze||!Ye,ariaLabel:"Manage class members",isMenuItem:!0},{label:"Delete Class",onClick:()=>we(!0),tooltip:"Permanently delete this class",disabled:ze||!ea,ariaLabel:"Delete class",variant:"delete",isMenuItem:!0}].filter((e=>"Create Board"!==e.label||aa)),isFavorited:(null===T||void 0===T?void 0:T.is_favorited)||!1,onFavoriteToggle:da,actionLoading:ze}}),[T,N,U,Ze,Ve,Ye,ea,aa,ze,J,ne,Ke,sa,va,da,s,L]);return R||Ke?(0,r.jsx)(g.A,{currentUser:B,onLogout:O,token:D,children:(0,r.jsx)(C.A,{})}):$?!T&&V&&"canceled"!==V?(L("Class not found or failed to load","error"),s("/classes"),null):(0,r.jsx)(j,{children:(0,r.jsxs)(g.A,{currentUser:B,onLogout:O,token:D,children:[(0,r.jsx)(f.A,{user:B,isOwnProfile:!0,headerData:Ca,userRole:Je}),(0,r.jsx)(p.A,{type:"boards",items:Ze,cardComponent:y.A,itemKey:"board_id",quickFilter:Te,setQuickFilter:Ue,searchQuery:Ne,setSearchQuery:Ge,filterOptions:E.HU,onResetFilters:ha,handleFavorite:oe,setEditingItem:e=>{Se(e),pe(!0)},setItemToDelete:De,setDeleteDialogOpen:Ce,handleManageMembers:ba,navigate:s,currentUser:B,token:D,onCreateNew:aa?sa:null,lastItemRef:Pe,hasMore:Y.hasMore,loading:ne,disabled:ze||J||ne}),(0,r.jsx)(h.A,{type:"boards",createOpen:be,editOpen:fe,deleteOpen:he,memberOpen:ye,item:$e,setItem:Re,editingItem:je,setEditingItem:Se,itemToDelete:Le,setItemToDelete:De,onSaveCreate:ta,onSaveEdit:ia,onCancelCreate:la,onCancelEdit:()=>{pe(!1),Se(null)},onConfirmDelete:ra,onCloseDelete:()=>{Ce(!1),De(null)},selectedId:Be,members:(null===(a=X.find((e=>e.board_id===Be)))||void 0===a?void 0:a.members)||[],addMember:(e,a)=>ca(e,a,!0),removeMember:(e,a)=>ua(e,a,!0),updateMemberRole:(e,a,s)=>ma(e,a,s,!0),onSaveMembers:()=>ga(!0),onCancelMembers:fa,disabled:ze||J||ne,loading:ze,token:D,gates:ce,classes:Q,currentClass:T,fixedClassId:S,initialClassId:S}),Me&&Ie&&(0,r.jsx)(h.A,{type:"classes",createOpen:!1,editOpen:Me,deleteOpen:xe,memberOpen:Ae,item:Ie,setItem:Ee,editingItem:Ie,setEditingItem:Ee,itemToDelete:S,setItemToDelete:()=>{},onSaveCreate:()=>{},onSaveEdit:oa,onCancelCreate:()=>{},onCancelEdit:()=>{ke(!1),Ee(null)},onConfirmDelete:na,onCloseDelete:()=>we(!1),selectedId:S,members:U||[],addMember:(e,a)=>ca(e,a,!1),removeMember:(e,a)=>ua(e,a,!1),updateMemberRole:(e,a,s)=>ma(e,a,s,!1),onSaveMembers:()=>ga(!1),onCancelMembers:pa,disabled:ze||J,loading:ze,token:D,gates:ce,classes:Q,currentGate:Ve})]})}):(s("/login",{state:{from:i.pathname}}),null)},L=l.memo(S)},9020:(e,a,s)=>{s.d(a,{A:()=>u});var l=s(5043),t=s(7353),i=s(1637),r=s(1922),o=s(1318),n=s(6552),d=s(579);const c=e=>{let{type:a,items:s,cardComponent:l,itemKey:c,quickFilter:u,setQuickFilter:m,searchQuery:v,setSearchQuery:b,filterOptions:g,onResetFilters:f,handleFavorite:p,setEditingItem:h,setItemToDelete:C,setDeleteDialogOpen:y,handleManageMembers:_,navigate:M,currentUser:k,token:x,onCreateNew:w,disabled:A,profileHeader:F,lastItemRef:I,hasMore:E,loading:j}=e;return(0,d.jsxs)(t.A,{sx:{...n.iH,maxWidth:"1500px",mx:"auto"},children:[F,(0,d.jsx)(r.A,{type:a,quickFilter:u,setQuickFilter:m,searchQuery:v,setSearchQuery:b,filterOptions:g,onReset:f}),(0,d.jsx)(o.A,{items:s,cardComponent:l,itemKey:c,gridType:a,handleFavorite:p,setEditingItem:h,setItemToDelete:C,setDeleteDialogOpen:y,handleManageMembers:_,navigate:M,currentUser:k,token:x,onCreateNew:w,disabled:A,lastItemRef:I,hasMore:E}),j&&E&&(0,d.jsx)(t.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,d.jsx)(i.A,{"aria-label":"Loading more items"})})]})},u=l.memo(c)}}]);
//# sourceMappingURL=897.cc10b59e.chunk.js.map