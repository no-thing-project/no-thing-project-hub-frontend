"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[728],{6728:(e,s,t)=>{t.r(s),t.d(s,{default:()=>A});var a=t(5043),r=t(1675),l=t(141),i=t(3536),n=t(8738),o=t(3769),c=t(342),u=t(1067),d=t(4074),m=t(3835),g=t(1654),b=t(3807),h=t(9020),f=t(5701),C=t(8800),p=t(4205),y=t(6411),v=t(2334),k=t(579);const M=e=>{let{children:s}=e;const[t,r]=(0,a.useState)(!1);(0,a.useCallback)(((e,s)=>{console.error("ErrorBoundary caught:",e,s),r(!0)}),[]);return t?(0,k.jsx)("div",{children:"Something went wrong. Please try again later."}):s},x=()=>{var e;const s=(0,r.Zp)(),t=(0,r.zy)(),{showNotification:x}=(0,g.h)(),{token:A,authData:w,handleLogout:F,isAuthenticated:j,loading:S}=(0,c.A)(),{classes:D,pagination:I,fetchClassesList:_,createNewClass:E,updateExistingClass:O,deleteExistingClass:L,addMemberToClass:Q,removeMemberFromClass:R,updateMemberRole:T,toggleFavoriteClass:q,loading:N,error:U}=(0,u.g)(A,F,s,!1),{gates:Z,fetchGatesList:K,loading:z,error:G}=(0,d.c)(A,F,s),[H,P]=(0,a.useState)(!1),[W,B]=(0,a.useState)(!1),[Y,$]=(0,a.useState)(!1),[J,V]=(0,a.useState)(!1),[X,ee]=(0,a.useState)(null),[se,te]=(0,a.useState)(null),[ae,re]=(0,a.useState)(null),[le,ie]=(0,a.useState)(y.Z6),[ne,oe]=(0,a.useState)("all"),[ce,ue]=(0,a.useState)(""),de=(0,a.useRef)(),me=(0,a.useCallback)((e=>{!N&&I.hasMore&&(de.current&&de.current.disconnect(),de.current=new IntersectionObserver((e=>{if(e[0].isIntersecting&&I.hasMore){const e=new AbortController;return _({visibility:"all"===ne?void 0:ne,page:I.page+1},e.signal,!0,(e=>{e&&"AbortError"!==e.name&&x(e.message||"Failed to load more classes","error")})),()=>e.abort()}})),e&&de.current.observe(e))}),[N,I.hasMore,I.page,ne,_,x]),ge=(0,a.useMemo)((()=>[()=>_({page:1,limit:I.limit},null,!1,(e=>{e&&"AbortError"!==e.name&&x(e.message||"Failed to fetch classes","error")}))]),[_,I.limit,x]),{isLoading:be,actionLoading:he,setActionLoading:fe}=(0,m.t)(ge,A,F,s,"classes"),Ce=(0,a.useMemo)((()=>(0,i.debounce)((e=>ue(e)),300)),[]);(0,a.useEffect)((()=>{U&&"canceled"!==U&&x(U,"error"),G&&"canceled"!==G&&x(G,"error")}),[U,G,x]);const pe=(0,a.useMemo)((()=>(0,p.w)(D||[],"classes",ne,ce,Z||[])),[D,Z,ne,ce]);(0,a.useEffect)((()=>{if(ce||"all"!==ne){const e=new AbortController;return K({visibility:"public"},e.signal,!1,(e=>{e&&"AbortError"!==e.name&&x(e.message||"Failed to fetch gates","error")})),()=>e.abort()}}),[ce,ne,K,x]);const ye=(0,a.useCallback)((()=>P(!0)),[]),ve=(0,a.useCallback)((()=>{P(!1),ie(y.Z6)}),[]),ke=(0,a.useCallback)((async e=>{var t;if(null!==(t=le.name)&&void 0!==t&&t.trim()){fe(!0);try{const t=await E({...le,gate_id:e||le.gate_id});P(!1),ie(y.Z6),x("Class created successfully!","success"),s(`/class/${t.class_id}`)}catch(a){x(a.message||"Failed to create class","error")}finally{fe(!1)}}else x("Class name is required!","error")}),[le,E,s,x,fe]),Me=(0,a.useCallback)((async()=>{var e;if(null!==X&&void 0!==X&&null!==(e=X.name)&&void 0!==e&&e.trim()){fe(!0);try{await O(X.class_id,X),B(!1),ee(null),x("Class updated successfully!","success")}catch(s){x(s.message||"Failed to update class","error")}finally{fe(!1)}}else x("Class name is required!","error")}),[X,O,x,fe]),xe=(0,a.useCallback)((async()=>{if(ae){fe(!0);try{await L(ae),V(!1),re(null),x("Class deleted successfully!","success")}catch(e){x(e.message||"Failed to delete class","error")}finally{fe(!1)}}}),[ae,L,x,fe]),Ae=(0,a.useCallback)((async(e,s)=>{fe(!0);try{var t,a;const r=D.find((s=>s.class_id===e));if((null===r||void 0===r||null===(t=r.members)||void 0===t?void 0:t.length)>=(null===r||void 0===r||null===(a=r.settings)||void 0===a?void 0:a.max_members))return void x("Maximum member limit reached!","error");await Q(e,s),x("Member added successfully!","success")}catch(r){x(r.message||"Failed to add member","error")}finally{fe(!1)}}),[Q,x,D,fe]),we=(0,a.useCallback)((async(e,s)=>{fe(!0);try{await R(e,s),x("Member removed successfully!","success")}catch(t){x(t.message||"Failed to remove member","error")}finally{fe(!1)}}),[R,x,fe]),Fe=(0,a.useCallback)((async(e,s,t)=>{fe(!0);try{await T(e,s,t),x("Member role updated successfully!","success")}catch(a){x(a.message||"Failed to update member role","error")}finally{fe(!1)}}),[T,x,fe]),je=(0,a.useCallback)((e=>{te(e),$(!0)}),[]),Se=(0,a.useCallback)((()=>{$(!1),te(null),x("Members updated successfully!","success")}),[x]),De=(0,a.useCallback)((()=>{$(!1),te(null)}),[]),Ie=(0,a.useCallback)((()=>{oe("all"),ue(""),Ce.cancel(),_({page:1,reset:{visibility:!0}},null,!1,(e=>{e&&"AbortError"!==e.name&&x(e.message||"Failed to reset filters","error")}))}),[Ce,_,x]),_e=(0,a.useMemo)((()=>({type:"page",title:"Classes",titleAriaLabel:"Classes page",shortDescription:"Organize Your Learning",tooltipDescription:"Classes are focused groups within Gates for specific topics or discussions. Create or join a Class to dive into structured conversations.",actions:[{label:"Create Class",icon:(0,k.jsx)(l.A,{}),onClick:ye,tooltip:"Create a new class",disabled:he||N||z,ariaLabel:"Create a new class"}]})),[ye,he,N,z]);return S||be?(0,k.jsx)(n.A,{currentUser:w,onLogout:F,token:A,children:(0,k.jsx)(C.A,{})}):j?(0,k.jsx)(M,{children:(0,k.jsxs)(n.A,{currentUser:w,onLogout:F,token:A,children:[(0,k.jsx)(o.A,{user:w,isOwnProfile:!0,headerData:_e}),(0,k.jsx)(h.A,{type:"classes",items:pe,cardComponent:b.A,itemKey:"class_id",quickFilter:ne,setQuickFilter:oe,searchQuery:ce,setSearchQuery:Ce,filterOptions:v.jW,onResetFilters:Ie,handleFavorite:q,setEditingItem:e=>{ee(e),B(!0)},setItemToDelete:re,setDeleteDialogOpen:V,handleManageMembers:je,navigate:s,currentUser:w,token:A,onCreateNew:ye,lastItemRef:me,hasMore:I.hasMore,loading:N,disabled:he||N||z}),(0,k.jsx)(f.A,{type:"classes",createOpen:H,editOpen:W,deleteOpen:J,memberOpen:Y,item:le,setItem:ie,editingItem:X,setEditingItem:ee,itemToDelete:ae,setItemToDelete:re,onSaveCreate:ke,onSaveEdit:Me,onCancelCreate:ve,onCancelEdit:()=>{B(!1),ee(null)},onConfirmDelete:xe,onCloseDelete:()=>{V(!1),re(null)},selectedId:se,members:(null===(e=D.find((e=>e.class_id===se)))||void 0===e?void 0:e.members)||[],addMember:Ae,removeMember:we,updateMemberRole:Fe,onSaveMembers:Se,onCancelMembers:De,disabled:he||N,loading:he,token:A,gates:Z})]})}):(s("/login",{state:{from:t.pathname}}),null)},A=a.memo(x)},9020:(e,s,t)=>{t.d(s,{A:()=>d});var a=t(5043),r=t(7353),l=t(1637),i=t(1922),n=t(1318),o=t(6552),c=t(579);const u=e=>{let{type:s,items:t,cardComponent:a,itemKey:u,quickFilter:d,setQuickFilter:m,searchQuery:g,setSearchQuery:b,filterOptions:h,onResetFilters:f,handleFavorite:C,setEditingItem:p,setItemToDelete:y,setDeleteDialogOpen:v,handleManageMembers:k,navigate:M,currentUser:x,token:A,onCreateNew:w,disabled:F,profileHeader:j,lastItemRef:S,hasMore:D,loading:I}=e;return(0,c.jsxs)(r.A,{sx:{...o.iH,maxWidth:"1500px",mx:"auto"},children:[j,(0,c.jsx)(i.A,{type:s,quickFilter:d,setQuickFilter:m,searchQuery:g,setSearchQuery:b,filterOptions:h,onReset:f}),(0,c.jsx)(n.A,{items:t,cardComponent:a,itemKey:u,gridType:s,handleFavorite:C,setEditingItem:p,setItemToDelete:y,setDeleteDialogOpen:v,handleManageMembers:k,navigate:M,currentUser:x,token:A,onCreateNew:w,disabled:F,lastItemRef:S,hasMore:D}),I&&D&&(0,c.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,c.jsx)(l.A,{"aria-label":"Loading more items"})})]})},d=a.memo(u)}}]);
//# sourceMappingURL=728.c4b25117.chunk.js.map