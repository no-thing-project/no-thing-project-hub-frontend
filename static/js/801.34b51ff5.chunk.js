"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[801],{3801:(e,r,t)=>{t.d(r,{A:()=>A,b:()=>$});var a=t(5043),o=t(3950),n=t.n(o),i=t(9472);const l="/api/v1/boards",s={TOKEN_REQUIRED:"Token is required",BOARD_ID_REQUIRED:"Board ID is required",GATE_ID_REQUIRED:"Gate ID is required",CLASS_ID_REQUIRED:"Class ID is required",PARENT_BOARD_ID_REQUIRED:"Parent board ID is required",USERNAME_REQUIRED:"Username is required",DATA_REQUIRED:"Board data is required",STATUS_REQUIRED:"Status is required"},d=(e,r)=>{if(!e||"string"!==typeof e||!e.trim())throw new Error(s[`${r.toUpperCase()}_REQUIRED`])},u=(e,r)=>{if(!e||"object"!==typeof e||0===Object.keys(e).length)throw new Error(s[`${r.toUpperCase()}_REQUIRED`])},c="Authentication required.",h="Board ID is missing.",m="Board name is missing.",v="Board not found.",b="Status data is missing.",w="Username is missing.",g="Role is missing.",E="Gate ID is required.",_="Class ID is required.",y="Parent board ID is required.",p="An error occurred.",f={MAX_CACHE_SIZE:10,CACHE_EXPIRY_MS:18e5,DEBOUNCE_MS:300,DEFAULT_LIMIT:50,CACHE_VERSION:"v1"};const I=new class{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return null;const{value:r,timestamp:t}=this.cache.get(e);return Date.now()-t>f.CACHE_EXPIRY_MS?(this.cache.delete(e),null):(this.cache.delete(e),this.cache.set(e,{value:r,timestamp:t}),r)}set(e,r){if(this.cache.size>=this.capacity){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,{value:r,timestamp:Date.now()})}clear(){this.cache.clear()}}(f.MAX_CACHE_SIZE),$=function(e,r,t){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const[s,$]=(0,a.useState)([]),[A,S]=(0,a.useState)(null),[C,B]=(0,a.useState)([]),[k,D]=(0,a.useState)({page:1,limit:f.DEFAULT_LIMIT,total:0,hasMore:!0}),[R,M]=(0,a.useState)(null),[P,U]=(0,a.useState)(null),[N,T]=(0,a.useState)(null),z=(0,a.useCallback)(((e,a)=>{if("AbortError"===e.name)return Promise.resolve(null);const o=e.status||500;401!==o&&403!==o||(r("Session expired. Please log in again."),t("/login"));const n=a||e.message||p;return T(n),Promise.reject(new Error(n))}),[r,t]),F=(0,a.useCallback)((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>({member_id:e.member_id||e.anonymous_id||"",username:e.username||"Unknown",role:e.role||"viewer",joined_at:e.joined_at||null,avatar:e.avatar||null,total_points:e.total_points||0,anonymous_id:e.anonymous_id||e.member_id||""})))}),[]),O=(0,a.useCallback)((()=>{$([]),S(null),B([]),D({page:1,limit:f.DEFAULT_LIMIT,total:0,hasMore:!0}),M(null),U(null),T(null),I.clear()}),[]),L=(0,a.useCallback)((async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return z(new Error,c);const{page:o=1,limit:n=f.DEFAULT_LIMIT}=r,s=`${f.CACHE_VERSION}:boards:${JSON.stringify({...r,page:o,limit:n})}`,u=I.get(s);if(u&&!a)return $(u.boards||[]),D(u.pagination||{page:o,limit:n,total:0,hasMore:!0}),M(null),U(null),Promise.resolve(u);T(null);try{var h,m,v;const u=await async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;d(e,"token");try{return(await(0,i.Jt)(l,{headers:{Authorization:`Bearer ${e}`},params:r,signal:t instanceof AbortSignal?t:void 0})).data.content||{boards:[],pagination:{}}}catch(N){throw(0,i.hS)(N)}}(e,{...r,page:o,limit:n},t);if(!u)throw new Error("No data received");const c=u.boards||[];return $((e=>a?[...e,...c]:c)),D({page:(null===(h=u.pagination)||void 0===h?void 0:h.page)||o,limit:(null===(m=u.pagination)||void 0===m?void 0:m.limit)||n,total:(null===(v=u.pagination)||void 0===v?void 0:v.total)||0,hasMore:c.length===n}),M(null),U(null),I.set(s,u),Promise.resolve(u)}catch(b){return"AbortError"===b.name?Promise.resolve(null):z(b,p)}}),[e,z]),q=(0,a.useMemo)((()=>n()(((e,r,t,a)=>{L(e,r,t).then((e=>a(null,e))).catch((e=>a(e,null)))}),f.DEBOUNCE_MS)),[L]),H=(0,a.useCallback)((async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||null===r||void 0===r||!r.trim())return z(new Error,e?E:c);const{page:n=1,limit:s=f.DEFAULT_LIMIT}=t,u=`${f.CACHE_VERSION}:gate:${r}:${JSON.stringify({...t,page:n,limit:s})}`,h=I.get(u);if(h&&!o)return $(h.boards||[]),D(h.pagination||{page:n,limit:s,total:0,hasMore:!0}),M(h.gate||null),U(null),Promise.resolve(h);T(null);try{var m,v,b;const c=await async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;d(e,"gateId"),d(r,"token");try{return(await(0,i.Jt)(`${l}/gates/${e}/boards`,{headers:{Authorization:`Bearer ${r}`},params:t,signal:a instanceof AbortSignal?a:void 0})).data.content||{boards:[],gate:null,pagination:{}}}catch(N){throw(0,i.hS)(N)}}(r,e,{...t,page:n,limit:s},a);if(!c)throw new Error("No data received");const h=c.boards||[];return $((e=>o?[...e,...h]:h)),D({page:(null===(m=c.pagination)||void 0===m?void 0:m.page)||n,limit:(null===(v=c.pagination)||void 0===v?void 0:v.limit)||s,total:(null===(b=c.pagination)||void 0===b?void 0:b.total)||0,hasMore:h.length===s}),M(c.gate||null),U(null),I.set(u,c),Promise.resolve(c)}catch(w){return"AbortError"===w.name?Promise.resolve(null):z(w,p)}}),[e,z]),J=(0,a.useMemo)((()=>n()(((e,r,t,a,o)=>{H(e,r,t,a).then((e=>o(null,e))).catch((e=>o(e,null)))}),f.DEBOUNCE_MS)),[H]),Q=(0,a.useCallback)((async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||null===r||void 0===r||!r.trim())return z(new Error,e?_:c);const{page:n=1,limit:s=f.DEFAULT_LIMIT}=t,u=`${f.CACHE_VERSION}:class:${r}:${JSON.stringify({...t,page:n,limit:s})}`,h=I.get(u);if(h&&!o)return $(h.boards||[]),D(h.pagination||{page:n,limit:s,total:0,hasMore:!0}),U(h.class||null),M(null),Promise.resolve(h);T(null);try{var m,v,b;const c=await async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;d(e,"classId"),d(r,"token");try{return(await(0,i.Jt)(`${l}/classes/${e}/boards`,{headers:{Authorization:`Bearer ${r}`},params:t,signal:a instanceof AbortSignal?a:void 0})).data.content||{boards:[],class:null,pagination:{}}}catch(N){throw(0,i.hS)(N)}}(r,e,{...t,page:n,limit:s},a);if(!c)throw new Error("No data received");const h=c.boards||[];return $((e=>o?[...e,...h]:h)),D({page:(null===(m=c.pagination)||void 0===m?void 0:m.page)||n,limit:(null===(v=c.pagination)||void 0===v?void 0:v.limit)||s,total:(null===(b=c.pagination)||void 0===b?void 0:b.total)||0,hasMore:h.length===s}),U(c.class||null),M(null),I.set(u,c),Promise.resolve(c)}catch(w){return"AbortError"===w.name?Promise.resolve(null):z(w,p)}}),[e,z]),x=(0,a.useMemo)((()=>n()(((e,r,t,a,o)=>{Q(e,r,t,a).then((e=>o(null,e))).catch((e=>o(e,null)))}),f.DEBOUNCE_MS)),[Q]),j=(0,a.useCallback)((async(r,t)=>{if(!e||null===r||void 0===r||!r.trim())return z(new Error,e?h:c);const a=`${f.CACHE_VERSION}:board:${r}`,o=I.get(a);if(o)return S(o),B(F(o.members)),Promise.resolve(o);T(null);try{const o=await(async(e,r,t)=>{d(e,"boardId"),d(r,"token");try{return(await(0,i.Jt)(`${l}/${e}`,{headers:{Authorization:`Bearer ${r}`},signal:t instanceof AbortSignal?t:void 0})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,e,t);if(!o)throw new Error("No board data received");return S(o),B(F(o.members||[])),I.set(a,o),Promise.resolve(o)}catch(n){return"AbortError"===n.name?Promise.resolve(null):z(n,v)}}),[e,z,F]),G=(0,a.useCallback)((async(r,t)=>{if(!e||null===r||void 0===r||!r.trim())return z(new Error,e?h:c);T(null);try{const a=await(async(e,r,t)=>{d(e,"boardId"),d(r,"token");try{return(await(0,i.Jt)(`${l}/${e}/members`,{headers:{Authorization:`Bearer ${r}`},signal:t instanceof AbortSignal?t:void 0})).data.content||{members:[]}}catch(N){throw(0,i.hS)(N)}})(r,e,t);if(!a)throw new Error("No members data received");return B(F(a.members)),Promise.resolve(a)}catch(a){return"AbortError"===a.name?Promise.resolve(null):z(a,p)}}),[e,z,F]),V=(0,a.useMemo)((()=>n()(((e,r,t)=>{G(e,r).then((e=>t(null,e))).catch((e=>t(e,null)))}),f.DEBOUNCE_MS)),[G]),X=(0,a.useCallback)((async r=>{var t;if(!e||null===r||void 0===r||null===(t=r.name)||void 0===t||!t.trim())return z(new Error,e?m:c);T(null);try{var a,o,n,s,h,v,b,w,g,E,_,y;const t=await(async(e,r)=>{u(e,"data"),d(r,"token");try{return(await(0,i.bE)(l,e,{headers:{Authorization:`Bearer ${r}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})({...r,visibility:r.visibility||"private",type:r.type||"personal",settings:{max_tweets:(null===(a=r.settings)||void 0===a?void 0:a.max_tweets)||100,max_members:(null===(o=r.settings)||void 0===o?void 0:o.max_members)||50,tweet_cost:(null===(n=r.settings)||void 0===n?void 0:n.tweet_cost)||1,favorite_cost:(null===(s=r.settings)||void 0===s?void 0:s.favorite_cost)||1,points_to_creator:(null===(h=r.settings)||void 0===h?void 0:h.points_to_creator)||1,allow_invites:null===(v=null===(b=r.settings)||void 0===b?void 0:b.allow_invites)||void 0===v||v,require_approval:null!==(w=null===(g=r.settings)||void 0===g?void 0:g.require_approval)&&void 0!==w&&w,ai_moderation_enabled:null===(E=null===(_=r.settings)||void 0===_?void 0:_.ai_moderation_enabled)||void 0===E||E,auto_archive_after:(null===(y=r.settings)||void 0===y?void 0:y.auto_archive_after)||30,...r.settings}},e);if(!t)throw new Error("Failed to create board");return $((e=>[...e,t])),I.clear(),Promise.resolve(t)}catch(f){return z(f,p)}}),[e,z]),Y=(0,a.useCallback)((async(r,t)=>{var a;if(!e||null===r||void 0===r||!r.trim()||null===t||void 0===t||null===(a=t.name)||void 0===a||!a.trim())return z(new Error,e?r?m:E:c);T(null);try{const a=await(async(e,r,t)=>{d(e,"gateId"),u(r,"data"),d(t,"token");try{return(await(0,i.bE)(`${l}/gates/${e}/boards`,r,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,t,e);if(!a)throw new Error("Failed to create board in gate");return $((e=>[...e,a])),I.clear(),Promise.resolve(a)}catch(o){return z(o,p)}}),[e,z]),Z=(0,a.useCallback)((async(r,t)=>{var a;if(!e||null===r||void 0===r||!r.trim()||null===t||void 0===t||null===(a=t.name)||void 0===a||!a.trim())return z(new Error,e?r?m:_:c);T(null);try{const{class_id:a,...o}=t,n=await(async(e,r,t)=>{d(e,"classId"),u(r,"data"),d(t,"token");try{return(await(0,i.bE)(`${l}/classes/${e}/boards`,r,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,o,e);if(!n)throw new Error("Failed to create board in class");return $((e=>[...e,n])),I.clear(),Promise.resolve(n)}catch(o){return z(o,p)}}),[e,z]),K=(0,a.useCallback)((async(r,t)=>{var a;if(!e||null===r||void 0===r||!r.trim()||null===t||void 0===t||null===(a=t.name)||void 0===a||!a.trim())return z(new Error,e?r?m:y:c);T(null);try{const a=await(async(e,r,t)=>{d(e,"parentBoardId"),u(r,"data"),d(t,"token");try{return(await(0,i.bE)(`${l}/boards/${e}/boards`,r,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,t,e);if(!a)throw new Error("Failed to create board in board");return $((e=>[...e,a])),I.clear(),Promise.resolve(a)}catch(o){return z(o,p)}}),[e,z]),W=(0,a.useCallback)((async(r,t)=>{var a;if(!e||null===r||void 0===r||!r.trim()||null===t||void 0===t||null===(a=t.name)||void 0===a||!a.trim())return z(new Error,e?r?m:h:c);T(null);try{const{board_id:a,...o}=t,n=await(async(e,r,t)=>{d(e,"boardId"),u(r,"data"),d(t,"token");try{return(await(0,i.yJ)(`${l}/${e}`,r,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,o,e);if(!n)throw new Error("Failed to update board");return $((e=>e.map((e=>e.board_id===r?n:e)))),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?n:e)),I.clear(),Promise.resolve(n)}catch(o){return z(o,p)}}),[e,z]),ee=(0,a.useCallback)((async(r,t)=>{if(!e||null===r||void 0===r||!r.trim()||!t)return z(new Error,e?r?b:h:c);T(null);try{const a=await(async(e,r,t)=>{d(e,"boardId"),u(r,"status"),d(t,"token");try{return(await(0,i.yJ)(`${l}/${e}/status`,r,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,t,e);if(!a)throw new Error("Failed to update board status");return $((e=>e.map((e=>e.board_id===r?a:e)))),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?a:e)),I.clear(),Promise.resolve(a)}catch(a){return z(a,p)}}),[e,z]),re=(0,a.useCallback)((async r=>{if(!e||null===r||void 0===r||!r.trim())return z(new Error,e?h:c);T(null);try{return await(async(e,r)=>{d(e,"boardId"),d(r,"token");try{return(await(0,i.yH)(`${l}/${e}`,{headers:{Authorization:`Bearer ${r}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,e),$((e=>e.filter((e=>e.board_id!==r)))),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?null:e)),I.clear(),Promise.resolve(!0)}catch(t){return z(t,p)}}),[e,z]),te=(0,a.useCallback)((async(r,t)=>{let{username:a,role:o="viewer"}=t;if(!e||null===r||void 0===r||!r.trim()||null===a||void 0===a||!a.trim())return z(new Error,e?r?w:h:c);T(null);try{const t=await(async(e,r,t)=>{d(e,"boardId"),u(r,"data"),d(t,"token");try{return(await(0,i.bE)(`${l}/${e}/members`,r,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,{username:a,role:o},e);if(!t)throw new Error("Failed to add member");return B(F(t.members)),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?t:e)),$((e=>e.map((e=>e.board_id===r?t:e)))),I.clear(),Promise.resolve(t)}catch(n){return z(n,p)}}),[e,z,F]),ae=(0,a.useCallback)((async(r,t)=>{if(!e||null===r||void 0===r||!r.trim()||null===t||void 0===t||!t.trim())return z(new Error,e?r?w:h:c);T(null);try{const a=await(async(e,r,t)=>{d(e,"boardId"),d(r,"username"),d(t,"token");try{return(await(0,i.yH)(`${l}/${e}/members/${encodeURIComponent(r)}`,{headers:{Authorization:`Bearer ${t}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,t,e);if(!a)throw new Error("Failed to remove member");return B(F(a.members)),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?a:e)),$((e=>e.map((e=>e.board_id===r?a:e)))),I.clear(),Promise.resolve(a)}catch(a){return z(a,p)}}),[e,z,F]),oe=(0,a.useCallback)((async(r,t,a)=>{if(!e||null===r||void 0===r||!r.trim()||null===t||void 0===t||!t.trim()||null===a||void 0===a||!a.trim())return z(new Error,e?r?t?g:w:h:c);T(null);try{const o=await(async(e,r,t,a)=>{d(e,"boardId"),d(r,"username"),u(t,"data"),d(a,"token");try{return(await(0,i.yJ)(`${l}/${e}/members/${encodeURIComponent(r)}`,t,{headers:{Authorization:`Bearer ${a}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,t,{role:a},e);if(!o)throw new Error("Failed to update member role");return B(F(o.members)),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?o:e)),$((e=>e.map((e=>e.board_id===r?o:e)))),I.clear(),Promise.resolve(o)}catch(o){return z(o,p)}}),[e,z,F]),ne=(0,a.useCallback)((async(r,t)=>{if(!e||null===r||void 0===r||!r.trim())return z(new Error,e?h:c);T(null);try{const a=t?await(async(e,r)=>{d(e,"boardId"),d(r,"token");try{return(await(0,i.bE)(`${l}/${e}/unfavorite`,{},{headers:{Authorization:`Bearer ${r}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,e):await(async(e,r)=>{d(e,"boardId"),d(r,"token");try{return(await(0,i.bE)(`${l}/${e}/favorite`,{},{headers:{Authorization:`Bearer ${r}`}})).data.content||null}catch(N){throw(0,i.hS)(N)}})(r,e);if(!a)throw new Error("Failed to toggle favorite status");return $((e=>e.map((e=>e.board_id===r?a:e)))),S((e=>(null===e||void 0===e?void 0:e.board_id)===r?a:e)),I.clear(),Promise.resolve(a)}catch(a){return z(a,p)}}),[e,z]);return(0,a.useEffect)((()=>{if(!e||o)return void O();const r=new AbortController;return q({},r.signal,!1,((e,r)=>{e&&"AbortError"!==e.name&&T(e.message||p)})),()=>{r.abort(),q.cancel(),V.cancel()}}),[e,o,O,q,V]),(0,a.useMemo)((()=>({boards:s,boardItem:A,members:C,pagination:k,gateInfo:R,classInfo:P,error:N,fetchBoardsList:q,fetchBoardsByGate:J,fetchBoardsByClass:x,fetchBoard:j,createNewBoard:X,createNewBoardInGate:Y,createNewBoardInClass:Z,createNewBoardInBoard:K,updateExistingBoard:W,updateBoardStatusById:ee,deleteExistingBoard:re,addMemberToBoard:te,removeMemberFromBoard:ae,updateMemberRole:oe,fetchBoardMembersList:V,toggleFavoriteBoard:ne,resetState:O})),[s,A,C,k,R,P,N,q,J,x,j,X,Y,Z,K,W,ee,re,te,ae,oe,V,ne,O])},A=$}}]);
//# sourceMappingURL=801.34b51ff5.chunk.js.map