"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[907],{7907:(e,a,r)=>{r.r(a),r.d(a,{default:()=>B});var t=r(5043),s=r(1675),o=r(141),l=r(3536),i=r(8738),n=r(3769),c=r(342),d=r(3801),u=r(1067),m=r(4074),b=r(3835),g=r(1654),f=r(3807),h=r(1922),p=r(1318),y=r(5701),v=r(8800),C=r(4205),k=r(6411),w=r(2334),M=r(579);const A=e=>{let{children:a}=e;const[r,s]=(0,t.useState)(!1);(0,t.useCallback)(((e,a)=>{console.error("ErrorBoundary caught:",e,a),s(!0)}),[]);return r?(0,M.jsx)("div",{children:"Something went wrong. Please try again later."}):a},F=()=>{var e;const a=(0,s.Zp)(),r=(0,s.zy)(),{showNotification:F}=(0,g.h)(),{token:B,authData:E,handleLogout:S,isAuthenticated:_,loading:x}=(0,c.A)(),{boards:j,pagination:I,fetchBoardsList:D,createNewBoard:L,updateExistingBoard:O,deleteExistingBoard:R,addMemberToBoard:T,removeMemberFromBoard:U,updateMemberRole:q,toggleFavoriteBoard:N,loading:P,error:Q}=(0,d.b)(B,S,a,!1),{classes:z,fetchClassesList:G,loading:H,error:K}=(0,u.g)(B,S,a,!0),{gates:Y,fetchGatesList:Z,loading:$,error:J}=(0,m.c)(B,S,a,!0),[V,W]=(0,t.useState)(!1),[X,ee]=(0,t.useState)(!1),[ae,re]=(0,t.useState)(!1),[te,se]=(0,t.useState)(!1),[oe,le]=(0,t.useState)(null),[ie,ne]=(0,t.useState)(null),[ce,de]=(0,t.useState)(null),[ue,me]=(0,t.useState)(k.pI),[be,ge]=(0,t.useState)("all"),[fe,he]=(0,t.useState)(""),pe=(0,t.useRef)(),ye=(0,t.useCallback)((e=>{!P&&I.hasMore&&(pe.current&&pe.current.disconnect(),pe.current=new IntersectionObserver((e=>{if(e[0].isIntersecting&&I.hasMore){const e=new AbortController;return D({visibility:"all"===be?void 0:be,page:I.page+1},e.signal,!0,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to load more boards","error")})),()=>e.abort()}})),e&&pe.current.observe(e))}),[P,I.hasMore,I.page,be,D,F]),ve=(0,t.useMemo)((()=>[()=>D({page:1,limit:I.limit},null,!1,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to fetch boards","error")})),()=>G({visibility:"public"},null,!1,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to fetch classes","error")})),()=>Z({visibility:"public"},null,!1,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to fetch gates","error")}))]),[D,G,Z,I.limit,F]),{isLoading:Ce,actionLoading:ke,setActionLoading:we}=(0,b.t)(ve,B,S,a,"boards"),Me=(0,t.useMemo)((()=>(0,l.debounce)((e=>he(e)),300)),[]);(0,t.useEffect)((()=>{Q&&"canceled"!==Q&&F(Q,"error"),K&&"canceled"!==K&&F(K,"error"),J&&"canceled"!==J&&F(J,"error")}),[Q,K,J,F]);const Ae=(0,t.useMemo)((()=>(0,C.w)(j||[],"boards",be,fe,Y||[],z||[])),[j,Y,z,be,fe]);(0,t.useEffect)((()=>{if(fe||"all"!==be){const e=new AbortController;return Promise.all([G({visibility:"public"},e.signal,!1,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to fetch classes","error")})),Z({visibility:"public"},e.signal,!1,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to fetch gates","error")}))]).catch((e=>{"AbortError"!==e.name&&F(e.message||"Failed to fetch related data","error")})),()=>e.abort()}}),[fe,be,G,Z,F]);const Fe=(0,t.useCallback)((()=>W(!0)),[]),Be=(0,t.useCallback)((()=>{W(!1),me(k.pI)}),[]),Ee=(0,t.useCallback)((async(e,r)=>{var t;if(null!==(t=ue.name)&&void 0!==t&&t.trim()){we(!0);try{let t;t=e?await L({...ue,gate_id:e}):r?await L({...ue,class_id:r}):await L(ue),W(!1),me(k.pI),F("Board created successfully!","success"),a(`/board/${t.board_id}`)}catch(s){F(s.message||"Failed to create board","error")}finally{we(!1)}}else F("Board name is required!","error")}),[ue,L,a,F,we]),Se=(0,t.useCallback)((async()=>{var e;if(null!==oe&&void 0!==oe&&null!==(e=oe.name)&&void 0!==e&&e.trim()){we(!0);try{await O(oe.board_id,oe),ee(!1),le(null),F("Board updated successfully!","success")}catch(a){F(a.message||"Failed to update board","error")}finally{we(!1)}}else F("Board name is required!","error")}),[oe,O,F,we]),_e=(0,t.useCallback)((async()=>{if(ce){we(!0);try{await R(ce),se(!1),de(null),F("Board deleted successfully!","success")}catch(e){F(e.message||"Failed to delete board","error")}finally{we(!1)}}}),[ce,R,F,we]),xe=(0,t.useCallback)((async(e,a)=>{we(!0);try{var r,t;const s=j.find((a=>a.board_id===e));if((null===s||void 0===s||null===(r=s.members)||void 0===r?void 0:r.length)>=(null===s||void 0===s||null===(t=s.settings)||void 0===t?void 0:t.max_members))return void F("Maximum member limit reached!","error");await T(e,a),F("Member added successfully!","success")}catch(s){F(s.message||"Failed to add member","error")}finally{we(!1)}}),[T,j,F,we]),je=(0,t.useCallback)((async(e,a)=>{we(!0);try{await U(e,a),F("Member removed successfully!","success")}catch(r){F(r.message||"Failed to remove member","error")}finally{we(!1)}}),[U,F,we]),Ie=(0,t.useCallback)((async(e,a,r)=>{we(!0);try{await q(e,a,r),F("Member role updated successfully!","success")}catch(t){F(t.message||"Failed to update member role","error")}finally{we(!1)}}),[q,F,we]),De=(0,t.useCallback)((e=>{ne(e),re(!0)}),[]),Le=(0,t.useCallback)((()=>{re(!1),ne(null),F("Members updated successfully!","success")}),[F]),Oe=(0,t.useCallback)((()=>{re(!1),ne(null)}),[]),Re=(0,t.useCallback)((()=>{ge("all"),he(""),Me.cancel(),D({page:1,reset:{visibility:!0}},null,!1,(e=>{e&&"AbortError"!==e.name&&F(e.message||"Failed to reset filters","error")}))}),[Me,D,F]),Te=(0,t.useMemo)((()=>({type:"page",title:"Boards",titleAriaLabel:"Boards page",shortDescription:"Your Spaces for Collaboration",tooltipDescription:"Boards are interactive spaces for discussions and tasks within classes or gates. Create a board to organize your projects or collaborate with others.",actions:_?[{label:"Create Board",icon:(0,M.jsx)(o.A,{}),onClick:Fe,tooltip:"Create a new board",disabled:ke||P||H||$,ariaLabel:"Create a new board"}]:[]})),[_,Fe,ke,P,H,$]);return x||Ce?(0,M.jsx)(i.A,{currentUser:E,onLogout:S,token:B,children:(0,M.jsx)(v.A,{})}):_?(0,M.jsx)(A,{children:(0,M.jsxs)(i.A,{currentUser:E,onLogout:S,token:B,children:[(0,M.jsx)(n.A,{user:E,isOwnProfile:!0,headerData:Te}),(0,M.jsx)(h.A,{type:"boards",quickFilter:be,setQuickFilter:ge,searchQuery:fe,setSearchQuery:Me,filterOptions:w.HU,onReset:Re}),(0,M.jsx)(p.A,{items:Ae,cardComponent:f.A,itemKey:"board_id",gridType:"boards",handleFavorite:N,setEditingItem:e=>{le(e),ee(!0)},setItemToDelete:de,setDeleteDialogOpen:se,handleManageMembers:De,navigate:a,currentUser:E,token:B,onCreateNew:Fe,lastItemRef:ye,hasMore:I.hasMore,loading:P,disabled:ke||P||H||$}),(0,M.jsx)(y.A,{type:"boards",createOpen:V,editOpen:X,deleteOpen:te,memberOpen:ae,item:ue,setItem:me,editingItem:oe,setEditingItem:le,itemToDelete:ce,setItemToDelete:de,onSaveCreate:Ee,onSaveEdit:Se,onCancelCreate:Be,onCancelEdit:()=>{ee(!1),le(null)},onConfirmDelete:_e,onCloseDelete:()=>{se(!1),de(null)},selectedId:ie,members:(null===(e=j.find((e=>e.board_id===ie)))||void 0===e?void 0:e.members)||[],addMember:xe,removeMember:je,updateMemberRole:Ie,onSaveMembers:Le,onCancelMembers:Oe,disabled:ke||P||H||$,loading:ke,token:B,gates:Y,classes:z})]})}):(a("/login",{state:{from:r.pathname}}),null)},B=t.memo(F)}}]);
//# sourceMappingURL=907.6b6e9d13.chunk.js.map