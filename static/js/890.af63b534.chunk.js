"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[890],{6890:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var s=r(5043),n=r(9412),a=r(4490),o=r(7353),i=r(1637),l=r(4496),d=r(1596),c=r(7784),u=r(1787),h=r(7392),p=r(1906),x=r(3632),m=r(3559),g=r(6213),w=r(1675),f=r(3488),A=r(6552),v=r(1654),b=r(579);const j=e=>{let{theme:t,onLogin:r}=e;const[j,k]=(0,s.useState)(""),[y,C]=(0,s.useState)(""),[P,S]=(0,s.useState)(""),[R,_]=(0,s.useState)(!1),[I,L]=(0,s.useState)(!1),[W,N]=(0,s.useState)(!1),[D,E]=(0,s.useState)(!0),[T,U]=(0,s.useState)(!1),q=(0,w.Zp)(),{showNotification:z}=(0,v.hN)();(0,s.useEffect)((()=>{(()=>{try{const e=window.location.hash||"",t=e.includes("?")?e.split("?")[1]:"",r=new URLSearchParams(t),s=new URLSearchParams(window.location.search),n=r.get("token")||s.get("token");n?(S(n),E(!1)):(z("No reset token found in the URL. Please check the link or request a new one.","error",{duration:4e3}),setTimeout((()=>q("/login",{replace:!0})),4e3))}catch(e){z("Invalid URL format. Please check the link or request a new one.","error",{duration:4e3}),setTimeout((()=>q("/login",{replace:!0})),4e3)}})()}),[q,z]);const H=(0,s.useCallback)((()=>j?/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&]{8,}$/.test(j)?j.length>128?"Password cannot exceed 128 characters":j!==y?"Passwords do not match":P?null:"Reset token is missing":"Password must contain at least 8 characters, uppercase, lowercase, and a number":"New password is required"),[j,y,P]),B=(0,s.useCallback)((async e=>{e.preventDefault(),N(!0),U(!0);const t=H();if(t)return z(t,"error"),N(!1),void U(!1);try{const e=await g.A.post(`${f.A.REACT_APP_HUB_API_URL}/api/v1/auth/set-password`,{token:P,newPassword:j}),{token:t,profile:s}=e.data;if(!t||!s)throw new Error("Invalid response: Missing token or profile");localStorage.setItem("token",t),r(t,s),z("Password successfully changed! Redirecting...","success"),setTimeout((()=>q("/home",{replace:!0})),2e3)}catch(d){var s,n,a,o,i,l;console.error("Error during reset password:",(null===(s=d.response)||void 0===s?void 0:s.data)||d);const e=(null===(n=d.response)||void 0===n||null===(a=n.data)||void 0===a||null===(o=a.errors)||void 0===o?void 0:o[0])||(null===(i=d.response)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.message)||"Network error, please try again";z(e,"error"),N(!1),U(!1)}}),[j,y,P,q,r,z,H]),M=(0,s.useCallback)((()=>q("/login",{replace:!0})),[q]),Z=(0,s.useCallback)(((e,t)=>{"Enter"!==e.key||W||(e.preventDefault(),t())}),[W]);return D||T?(0,b.jsx)(n.A,{theme:t,children:(0,b.jsx)(a.A,{maxWidth:"sm",sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsxs)(o.A,{sx:{textAlign:"center"},"aria-live":"polite","aria-busy":"true",children:[(0,b.jsx)(i.A,{"aria-label":"Loading",sx:{mb:2}}),(0,b.jsx)(l.A,{variant:"body1",sx:{color:"text.primary"},children:D?"Loading reset password form\u2026":"Resetting password\u2026"})]})})}):(0,b.jsx)(n.A,{theme:t,children:(0,b.jsx)(a.A,{maxWidth:"sm",sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsxs)(d.A,{elevation:6,sx:{p:t.spacing(5),borderRadius:t.shape.borderRadiusMedium,backgroundColor:"background.paper",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:t.custom.loginPaperMaxWidth,textAlign:"center"},children:[(0,b.jsxs)(o.A,{sx:{textAlign:"center",mb:t.spacing(3)},children:[(0,b.jsx)(l.A,{variant:"h4",sx:{color:"text.primary",fontWeight:600},children:"Create New Password"}),(0,b.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",mt:1},children:"Enter your new password to continue"})]}),(0,b.jsxs)(o.A,{component:"form",onSubmit:B,noValidate:!0,sx:{mt:2,textAlign:"left"},"aria-label":"Reset password form",children:[(0,b.jsx)(c.A,{label:"New Password",type:R?"text":"password",fullWidth:!0,margin:"normal",value:j,onChange:e=>k(e.target.value),onKeyDown:e=>Z(e,(()=>B(e))),InputProps:{notched:!1,endAdornment:(0,b.jsx)(u.A,{position:"end",children:(0,b.jsx)(h.A,{name:"password-visibility",onClick:()=>_(!R),edge:"end","aria-label":R?"Hide new password":"Show new password",sx:{color:"text.primary"},children:R?(0,b.jsx)(x.A,{}):(0,b.jsx)(m.A,{})})})},sx:A.z9,required:!0}),(0,b.jsx)(c.A,{label:"Confirm Password",type:I?"text":"password",fullWidth:!0,margin:"normal",value:y,onChange:e=>C(e.target.value),onKeyDown:e=>Z(e,(()=>B(e))),InputProps:{notched:!1,endAdornment:(0,b.jsx)(u.A,{position:"end",children:(0,b.jsx)(h.A,{onClick:()=>L(!I),edge:"end","aria-label":I?"Hide confirm password":"Show confirm password",sx:{color:"text.primary"},children:I?(0,b.jsx)(x.A,{}):(0,b.jsx)(m.A,{})})})},sx:A.z9,required:!0}),(0,b.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",mt:t.spacing(3),gap:t.spacing(3),alignItems:"center"},children:[(0,b.jsx)(p.A,{type:"submit",variant:"contained",disabled:W,fullWidth:!0,sx:A.nT,"aria-label":"Change password",children:W?"Changing Password...":"Change Password"}),(0,b.jsx)(p.A,{variant:"text",onClick:M,sx:{color:"text.primary",textTransform:"none",fontSize:"0.875rem","&:hover":{textDecoration:"underline"}},"aria-label":"Back to login",children:"Back to Login"})]})]})]})})})}}}]);
//# sourceMappingURL=890.af63b534.chunk.js.map