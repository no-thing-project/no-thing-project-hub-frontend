"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[890],{6890:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var n=r(5043),s=r(9412),o=r(4490),a=r(1637),i=r(1596),l=r(7353),d=r(4496),c=r(7784),h=r(1787),u=r(7392),p=r(1906),x=r(3632),m=r(3559),g=r(6213),w=r(1675),f=r(3488),A=r(6552),v=r(1654),j=r(579);const k=e=>{let{theme:t,onLogin:r}=e;const[k,b]=(0,n.useState)(""),[y,P]=(0,n.useState)(""),[C,S]=(0,n.useState)(""),[_,R]=(0,n.useState)(!1),[I,L]=(0,n.useState)(!1),[W,N]=(0,n.useState)(!1),[T,U]=(0,n.useState)(!0),q=(0,w.Zp)(),{showNotification:z}=(0,v.hN)();(0,n.useEffect)((()=>{(()=>{try{const e=window.location.hash||"",t=e.includes("?")?e.split("?")[1]:"",r=new URLSearchParams(t),n=new URLSearchParams(window.location.search),s=r.get("token")||n.get("token");s?(S(s),U(!1)):(z("No reset token found in the URL. Please check the link or request a new one.","error",{duration:4e3}),setTimeout((()=>q("/login",{replace:!0})),4e3))}catch(e){z("Invalid URL format. Please check the link or request a new one.","error",{duration:4e3}),setTimeout((()=>q("/login",{replace:!0})),4e3)}})()}),[q,z]);return T?(0,j.jsx)(s.A,{theme:t,children:(0,j.jsx)(o.A,{maxWidth:"sm",sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,j.jsx)(a.A,{"aria-label":"Loading reset password form"})})}):(0,j.jsx)(s.A,{theme:t,children:(0,j.jsx)(o.A,{maxWidth:"sm",sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,j.jsxs)(i.A,{elevation:6,sx:{p:t.spacing(5),borderRadius:t.shape.borderRadiusMedium,backgroundColor:"background.paper",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:t.custom.loginPaperMaxWidth,textAlign:"center"},children:[(0,j.jsxs)(l.A,{sx:{textAlign:"center",mb:t.spacing(3)},children:[(0,j.jsx)(d.A,{variant:"h4",sx:{color:"text.primary",fontWeight:600},children:"Create New Password"}),(0,j.jsx)(d.A,{variant:"subtitle1",sx:{color:"text.secondary",mt:1},children:"Enter your new password to continue"})]}),(0,j.jsxs)(l.A,{component:"form",onSubmit:async e=>{e.preventDefault(),N(!0);const t=k?/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&]{8,}$/.test(k)?k.length>128?"Password cannot exceed 128 characters":k!==y?"Passwords do not match":C?null:"Reset token is missing":"Password must contain at least 8 characters, uppercase, lowercase, and a number":"New password is required";if(t)return z(t,"error"),void N(!1);try{const e=await g.A.post(`${f.A.REACT_APP_HUB_API_URL}/api/v1/auth/set-password`,{token:C,newPassword:k}),{token:t,profile:n}=e.data;if(!t||!n)throw new Error("Invalid response: Missing token or profile");localStorage.setItem("token",t),r(t,n),z("Password successfully changed! Logging you in...","success"),setTimeout((()=>q("/home",{replace:!0})),2e3)}catch(d){var n,s,o,a,i,l;console.error("Error during reset password:",(null===(n=d.response)||void 0===n?void 0:n.data)||d);const e=(null===(s=d.response)||void 0===s||null===(o=s.data)||void 0===o||null===(a=o.errors)||void 0===a?void 0:a[0])||(null===(i=d.response)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.message)||"Network error, please try again";z(e,"error"),N(!1)}},noValidate:!0,sx:{mt:2,textAlign:"left"},"aria-label":"Reset password form",children:[(0,j.jsx)(c.A,{label:"New Password",type:_?"text":"password",fullWidth:!0,margin:"normal",value:k,onChange:e=>b(e.target.value),InputProps:{notched:!1,endAdornment:(0,j.jsx)(h.A,{position:"end",children:(0,j.jsx)(u.A,{onClick:()=>R(!_),edge:"end","aria-label":_?"Hide new password":"Show new password",sx:{color:"text.primary"},children:_?(0,j.jsx)(x.A,{}):(0,j.jsx)(m.A,{})})})},sx:A.z9,required:!0}),(0,j.jsx)(c.A,{label:"Confirm Password",type:I?"text":"password",fullWidth:!0,margin:"normal",value:y,onChange:e=>P(e.target.value),InputProps:{notched:!1,endAdornment:(0,j.jsx)(h.A,{position:"end",children:(0,j.jsx)(u.A,{onClick:()=>L(!I),edge:"end","aria-label":I?"Hide confirm password":"Show confirm password",sx:{color:"text.primary"},children:I?(0,j.jsx)(x.A,{}):(0,j.jsx)(m.A,{})})})},sx:A.z9,required:!0}),(0,j.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",mt:t.spacing(3),gap:t.spacing(3),alignItems:"center"},children:[(0,j.jsx)(p.A,{type:"submit",variant:"contained",disabled:W,fullWidth:!0,sx:A.nT,"aria-label":"Change password",children:W?"Changing Password...":"Change Password"}),(0,j.jsx)(p.A,{variant:"text",onClick:()=>q("/login",{replace:!0}),sx:{color:"text.primary",textTransform:"none",fontSize:"0.875rem","&:hover":{textDecoration:"underline"}},"aria-label":"Back to login",children:"Back to Login"})]})]})]})})})}}}]);
//# sourceMappingURL=890.6988b803.chunk.js.map