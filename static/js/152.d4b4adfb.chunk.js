"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[152],{6152:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var s=a(5043),r=a(1675),l=a(141),i=a(3536),n=a(8738),o=a(3769),c=a(342),u=a(4074),d=a(3835),m=a(1654),g=a(3807),b=a(9020),p=a(5701),h=a(8800),f=a(4205),y=a(6411),C=a(2334),k=a(579);const v=e=>{let{children:t}=e;const[a,r]=(0,s.useState)(!1);(0,s.useCallback)(((e,t)=>{console.error("ErrorBoundary caught:",e,t),r(!0)}),[]);return a?(0,k.jsx)("div",{children:"Something went wrong. Please try again later."}):t},M=()=>{var e;const t=(0,r.Zp)(),{showNotification:a}=(0,m.h)(),{token:M,authData:x,handleLogout:w,isAuthenticated:A,loading:F}=(0,c.A)(),{gates:S,pagination:j,fetchGatesList:D,createNewGate:G,updateExistingGate:I,deleteExistingGate:_,addMemberToGate:E,removeMemberFromGate:O,updateMemberRole:L,toggleFavoriteGate:Q,loading:R,error:T}=(0,u.c)(M,w,t),[q,N]=(0,s.useState)(!1),[U,K]=(0,s.useState)(!1),[V,B]=(0,s.useState)(!1),[H,P]=(0,s.useState)(!1),[W,Y]=(0,s.useState)(null),[Z,$]=(0,s.useState)(null),[z,J]=(0,s.useState)(null),[X,ee]=(0,s.useState)(y.sV),[te,ae]=(0,s.useState)("all"),[se,re]=(0,s.useState)(""),le=(0,s.useRef)(),ie=(0,s.useCallback)((e=>{!R&&j.hasMore&&(le.current&&le.current.disconnect(),le.current=new IntersectionObserver((e=>{if(e[0].isIntersecting&&j.hasMore){const e=new AbortController;return D({page:j.page+1,limit:j.limit},e.signal,!0,(e=>{e&&"AbortError"!==e.name&&a(e.message||"Failed to load more gates","error")})),()=>e.abort()}})),e&&le.current.observe(e))}),[R,j.hasMore,j.page,j.limit,D,a]),ne=(0,s.useMemo)((()=>[()=>D({page:1,limit:j.limit},null,!1,(e=>{e&&"AbortError"!==e.name&&a(e.message||"Failed to fetch gates","error")}))]),[D,j.limit,a]),{isLoading:oe,actionLoading:ce,setActionLoading:ue}=(0,d.t)(ne,M,w,t,"gates"),de=(0,s.useMemo)((()=>(0,i.debounce)((e=>re(e)),300)),[]);(0,s.useEffect)((()=>{T&&a(T,"error")}),[T,a]);const me=(0,s.useMemo)((()=>(0,f.w)(S,"gates",te,se)),[S,te,se]),ge=(0,s.useCallback)((()=>N(!0)),[]),be=(0,s.useCallback)((()=>{N(!1),ee(y.sV)}),[]),pe=(0,s.useCallback)((async()=>{if(X.name.trim()){ue(!0);try{const e=await G(X);N(!1),ee(y.sV),a("Gate created successfully!","success"),t(`/gate/${e.gate_id}`)}catch(e){a(e.message||"Failed to create gate","error")}finally{ue(!1)}}else a("Gate name is required!","error")}),[X,G,t,a,ue]),he=(0,s.useCallback)((async()=>{if(null!==Z&&void 0!==Z&&Z.name.trim()){ue(!0);try{await I(Z.gate_id,Z),K(!1),$(null),a("Gate updated successfully!","success")}catch(e){a(e.message||"Failed to update gate","error")}finally{ue(!1)}}else a("Gate name is required!","error")}),[Z,I,a,ue]),fe=(0,s.useCallback)((async()=>{if(z){ue(!0);try{await _(z),P(!1),J(null),a("Gate deleted successfully!","success")}catch(e){a(e.message||"Failed to delete gate","error")}finally{ue(!1)}}}),[z,_,a,ue]),ye=(0,s.useCallback)((async(e,t)=>{ue(!0);try{var s,r;const l=S.find((t=>t.gate_id===e));if((null===l||void 0===l||null===(s=l.members)||void 0===s?void 0:s.length)>=(null===l||void 0===l||null===(r=l.settings)||void 0===r?void 0:r.max_members))return void a("Maximum member limit reached!","error");await E(e,t),a("Member added successfully!","success")}catch(l){a(l.message||"Failed to add member","error")}finally{ue(!1)}}),[E,a,S,ue]),Ce=(0,s.useCallback)((async(e,t)=>{ue(!0);try{await O(e,t),a("Member removed successfully!","success")}catch(s){a(s.message||"Failed to remove member","error")}finally{ue(!1)}}),[O,a,ue]),ke=(0,s.useCallback)((async(e,t,s)=>{ue(!0);try{await L(e,t,s),a("Member role updated successfully!","success")}catch(r){a(r.message||"Failed to update member role","error")}finally{ue(!1)}}),[L,a,ue]),ve=(0,s.useCallback)((e=>{Y(e),B(!0)}),[]),Me=(0,s.useCallback)((()=>{B(!1),Y(null),a("Members updated successfully!","success")}),[a]),xe=(0,s.useCallback)((()=>{B(!1),Y(null)}),[]),we=(0,s.useCallback)((()=>{ae("all"),re(""),de.cancel(),D({page:1,reset:{visibility:!0}},null,!1,(e=>{e&&"AbortError"!==e.name&&a(e.message||"Failed to reset filters","error")}))}),[de,D,a]),Ae=(0,s.useMemo)((()=>({type:"page",title:"Gates",titleAriaLabel:"Gates page",shortDescription:"Your Space for Big Ideas",tooltipDescription:"Gates are like forum topics, starting points for broad discussions. Create a Gate to spark a conversation or join one to explore shared interests.",actions:[{label:"Create Gate",icon:(0,k.jsx)(l.A,{}),onClick:ge,tooltip:"Create a new gate",disabled:ce||R,ariaLabel:"Create a new gate"}]})),[ge,ce,R]);return F||oe?(0,k.jsx)(n.A,{currentUser:x,onLogout:w,token:M,children:(0,k.jsx)(h.A,{})}):A?(0,k.jsx)(v,{children:(0,k.jsxs)(n.A,{currentUser:x,onLogout:w,token:M,children:[(0,k.jsx)(o.A,{user:x,isOwnProfile:!0,headerData:Ae}),(0,k.jsx)(b.A,{type:"gates",items:me,cardComponent:g.A,itemKey:"gate_id",quickFilter:te,setQuickFilter:ae,searchQuery:se,setSearchQuery:de,filterOptions:C.ak,onResetFilters:we,handleFavorite:Q,setEditingItem:e=>{$(e),K(!0)},setItemToDelete:J,setDeleteDialogOpen:P,handleManageMembers:ve,navigate:t,currentUser:x,token:M,onCreateNew:ge,lastItemRef:ie,hasMore:j.hasMore,loading:R,disabled:ce||R}),(0,k.jsx)(p.A,{type:"gates",createOpen:q,editOpen:U,deleteOpen:H,memberOpen:V,item:X,setItem:ee,editingItem:Z,setEditingItem:$,itemToDelete:z,setItemToDelete:J,onSaveCreate:pe,onSaveEdit:he,onCancelCreate:be,onCancelEdit:()=>{K(!1),$(null)},onConfirmDelete:fe,onCloseDelete:()=>{P(!1),J(null)},selectedId:W,members:(null===(e=S.find((e=>e.gate_id===W)))||void 0===e?void 0:e.members)||[],addMember:ye,removeMember:Ce,updateMemberRole:ke,onSaveMembers:Me,onCancelMembers:xe,disabled:ce||R,loading:ce,token:M})]})}):(t("/login",{state:{from:window.location.pathname}}),null)},x=s.memo(M)},9020:(e,t,a)=>{a.d(t,{A:()=>d});var s=a(5043),r=a(7353),l=a(1637),i=a(1922),n=a(1318),o=a(6552),c=a(579);const u=e=>{let{type:t,items:a,cardComponent:s,itemKey:u,quickFilter:d,setQuickFilter:m,searchQuery:g,setSearchQuery:b,filterOptions:p,onResetFilters:h,handleFavorite:f,setEditingItem:y,setItemToDelete:C,setDeleteDialogOpen:k,handleManageMembers:v,navigate:M,currentUser:x,token:w,onCreateNew:A,disabled:F,profileHeader:S,lastItemRef:j,hasMore:D,loading:G}=e;return(0,c.jsxs)(r.A,{sx:{...o.iH,maxWidth:"1500px",mx:"auto"},children:[S,(0,c.jsx)(i.A,{type:t,quickFilter:d,setQuickFilter:m,searchQuery:g,setSearchQuery:b,filterOptions:p,onReset:h}),(0,c.jsx)(n.A,{items:a,cardComponent:s,itemKey:u,gridType:t,handleFavorite:f,setEditingItem:y,setItemToDelete:C,setDeleteDialogOpen:k,handleManageMembers:v,navigate:M,currentUser:x,token:w,onCreateNew:A,disabled:F,lastItemRef:j,hasMore:D}),G&&D&&(0,c.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,c.jsx)(l.A,{"aria-label":"Loading more items"})})]})},d=s.memo(u)}}]);
//# sourceMappingURL=152.d4b4adfb.chunk.js.map