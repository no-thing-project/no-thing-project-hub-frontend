"use strict";(self.webpackChunkgate_from_nothingproject_front_end=self.webpackChunkgate_from_nothingproject_front_end||[]).push([[483],{3769:(e,i,n)=>{n.d(i,{A:()=>k});var t=n(5043),l=n(6240),s=n(7353),a=n(4496),o=n(7392),r=n(2110),d=n(6494),c=n(8185),u=n(1906),g=n(378),x=n(2143),h=n(3845),v=n(6973),f=n(9320),p=n(8942),m=n(8558),A=n(6552),b=n(3290),j=n(579);const y=b.i7`
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
`,E=["IGNITION","VISIONARY","MOMENTUM","CREATION","CORE"],C={BELIEVER:{gradient:"linear-gradient(45deg, #A1A1A1, #707070)"},NOVICE:{gradient:"linear-gradient(45deg, #BDC3C7, #2C3E50)"},SUPPORTER:{gradient:"linear-gradient(45deg, #7F8C8D, #95A5A6)"},INITIATE:{gradient:"linear-gradient(45deg, #FAD7A0, #E67E22)"},PIONEER:{gradient:"linear-gradient(45deg, #34495E, #2C3E50)"},TRAILBLAZER:{gradient:"linear-gradient(45deg, #FF6F61, #D7263D)"},ELEVATE:{gradient:"linear-gradient(45deg, #7B4397, #DC2430)"},CATALYST:{gradient:"linear-gradient(45deg, #11998E, #38EF7D)"},ACCELERATOR:{gradient:"linear-gradient(45deg, #16A085, #F4D03F)"},IGNITION:{gradient:"linear-gradient(45deg, #FF512F, #DD2476)"},VISIONARY:{gradient:"linear-gradient(45deg, #FC466B, #3F5EFB)"},INNOVATOR:{gradient:"linear-gradient(45deg, #8E44AD, #3498DB)"},MOMENTUM:{gradient:"linear-gradient(45deg, #00B09B, #96C93D)"},SPARK:{gradient:"linear-gradient(45deg, #F7971E, #FFD200)"},ARCHITECT:{gradient:"linear-gradient(45deg, #2ECC71, #27AE60)"},CREATION:{gradient:"linear-gradient(45deg, #F953C6, #B91D73)"},LUMINARY:{gradient:"linear-gradient(45deg, #F1C40F, #E67E22)"},LEGEND:{gradient:"linear-gradient(45deg, #D35400, #C0392B)"},TITAN:{gradient:"linear-gradient(45deg, #2C3E50, #4CA1AF)"},BUILDER:{gradient:"linear-gradient(45deg, #7F8C8D, #95A5A6)"},SHAPER:{gradient:"linear-gradient(45deg, #34495E, #5D6D7E)"},FORGE:{gradient:"linear-gradient(45deg, #E74C3C, #C0392B)"},ASCENDANT:{gradient:"linear-gradient(45deg, #3498DB, #2ECC71)"},BEACON:{gradient:"linear-gradient(45deg, #F1C40F, #F39C12)"},VANGUARD:{gradient:"linear-gradient(45deg, #8E44AD, #9B59B6)"},SENTINEL:{gradient:"linear-gradient(45deg, #2C3E50, #34495E)"},PILLAR:{gradient:"linear-gradient(45deg, #95A5A6, #7F8C8D)"},ETHEREAL:{gradient:"linear-gradient(45deg, #7F00FF, #E100FF)"},ETERNAL:{gradient:"linear-gradient(45deg, #1D2671, #C33764)"},SOUL:{gradient:"linear-gradient(90deg, #34495E 0%, #7B4397 16%, #38EF7D 33%, #FFD200 50%, #FF512F 67%, #3F5EFB 83%, #F953C6 100%)"},CORE:{gradient:"linear-gradient(90deg, #34495E 0%, #7B4397 16%, #38EF7D 33%, #FFD200 50%, #FF512F 67%, #3F5EFB 83%, #F953C6 100%)",textShadow:"0 0 6px rgba(255,255,255,0.2), 0 0 12px rgba(255,255,255,0.2)"},DEFAULT:{gradient:"linear-gradient(45deg, #bdbdbd, #9e9e9e)"}},_=e=>{let{level:i}=e;const n=(0,l.A)(),s=(0,t.useMemo)((()=>(e=>{const i=C[e]||C.DEFAULT;let n={display:"inline-block",fontWeight:"bold",textTransform:"uppercase",fontSize:{xs:"0.875rem",sm:"1rem",md:"1.2rem"},color:"transparent",backgroundClip:"text",WebkitBackgroundClip:"text",backgroundImage:i.gradient,backgroundSize:"100% 100%",margin:"0 4px"};return E.includes(e)&&(n={...n,backgroundSize:"400% 400%",animation:`${y} 10s ease infinite`,textShadow:i.textShadow?`${i.textShadow}, 0 0 8px rgba(255,255,255,0.4)`:"0 0 8px rgba(255,255,255,0.4)"}),n})(i)),[i,n]);return(0,j.jsx)(a.A,{component:"span",sx:s,children:i||"UNKNOWN"})};var w=n(9392),S=n(8978),D=n(5442);const k=t.memo((e=>{var i;let{user:n,isOwnProfile:b,headerData:y,userRole:E,children:C}=e;const k=(0,l.A)(),[F,P]=((0,D.A)(k.breakpoints.down("sm")),(0,t.useState)(null)),[N,z]=(0,t.useState)(null),I=Boolean(F),T=(0,t.useMemo)((()=>(0,j.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:{xs:"center",sm:"flex-start"}},children:[(0,j.jsx)(a.A,{variant:"body2",sx:{...A.ar.level,fontSize:{xs:"0.875rem",sm:"1rem"}},"aria-label":`Page description: ${(null===y||void 0===y?void 0:y.shortDescription)||""}`,children:null===y||void 0===y?void 0:y.shortDescription}),(null===y||void 0===y?void 0:y.tooltipDescription)&&(0,j.jsx)(w.A,{title:y.tooltipDescription,placement:"top",arrow:!0,slotProps:{popper:{sx:{[`& .${S.A.tooltip}`]:{padding:2}},modifiers:[{name:"offset",options:{offset:[0,-10]}}]}},children:(0,j.jsx)(o.A,{size:"small","aria-label":"More information about this page",sx:{p:0},children:(0,j.jsx)(v.A,{fontSize:"small"})})})]})),[null===y||void 0===y?void 0:y.shortDescription,null===y||void 0===y?void 0:y.tooltipDescription]),O=(0,t.useCallback)((e=>P(e.currentTarget)),[]),L=(0,t.useCallback)((()=>P(null)),[]),B=(0,t.useCallback)((e=>{e(),L()}),[L]),R=(0,t.useCallback)((e=>{z((i=>i===e?null:e))}),[]),$=(0,t.useMemo)((()=>["owner","admin"].includes(E)),[E]),M=(0,t.useMemo)((()=>{var e;return(null===y||void 0===y||null===(e=y.actions)||void 0===e?void 0:e.filter((e=>e.isMenuItem)))||[]}),[null===y||void 0===y?void 0:y.actions]),V=(0,t.useMemo)((()=>{var e;return(null===y||void 0===y||null===(e=y.actions)||void 0===e?void 0:e.filter((e=>!e.isMenuItem)))||[]}),[null===y||void 0===y?void 0:y.actions]),H=(0,t.useMemo)((()=>"user"!==(null===y||void 0===y?void 0:y.type)&&"page"!==(null===y||void 0===y?void 0:y.type)&&!(null===y||void 0===y||!y.onFavoriteToggle)),[null===y||void 0===y?void 0:y.type,null===y||void 0===y?void 0:y.onFavoriteToggle]),U=(0,t.useMemo)((()=>"user"!==(null===y||void 0===y?void 0:y.type)&&"page"!==(null===y||void 0===y?void 0:y.type)&&$&&M.length>0),[null===y||void 0===y?void 0:y.type,$,M.length]),q=(0,t.useMemo)((()=>"page"===(null===y||void 0===y?void 0:y.type)&&!!C||V.length>0),[null===y||void 0===y?void 0:y.type,C,V.length]);if(!n)return(0,j.jsx)(r.A,{sx:{...A.ar.card,width:{xs:"100%",customSm:"auto"}},children:(0,j.jsx)(d.A,{children:(0,j.jsx)(s.A,{sx:A.ar.content,children:(0,j.jsxs)(s.A,{children:[(0,j.jsx)(c.A,{variant:"text",width:200,height:40}),(0,j.jsx)(c.A,{variant:"text",width:100,height:20,sx:{mt:1}})]})})})});if(!y)return(0,j.jsx)(r.A,{sx:{...A.ar.card,width:{xs:"100%",customSm:"auto"}},children:(0,j.jsx)(d.A,{children:(0,j.jsxs)(s.A,{sx:A.ar.content,children:[(0,j.jsxs)(s.A,{sx:A.ar.leftSection,children:[(0,j.jsx)(a.A,{variant:"h4",sx:{...A.ar.title,fontSize:{xs:"1.5rem",customSm:"2rem",md:"2.5rem"}},"aria-label":`Username: ${n.username}`,children:n.username}),(0,j.jsxs)(a.A,{variant:"body2",sx:{...A.ar.level,fontSize:{xs:"0.875rem",customSm:"1rem"}},children:["Level: ",(0,j.jsx)(_,{level:n.access_level})]})]}),b&&C&&(0,j.jsx)(s.A,{sx:A.ar.buttonGroup,children:C})]})})});return(0,j.jsx)(r.A,{sx:{...A.ar.card,width:{xs:"100%",customSm:"auto"},position:"relative"},children:(0,j.jsxs)(d.A,{children:[H&&(0,j.jsx)(s.A,{sx:{display:{xs:"block",customSm:"none"},position:"absolute",top:8,right:8},children:(0,j.jsx)(w.A,{title:y.isFavorited?`Remove ${y.type} from favorites`:`Add ${y.type} to favorites`,children:(0,j.jsx)(o.A,{onClick:y.onFavoriteToggle,disabled:y.actionLoading,"aria-label":y.isFavorited?"Remove from favorites":"Add to favorites",children:y.isFavorited?(0,j.jsx)(f.A,{color:"warning"}):(0,j.jsx)(p.A,{})})})}),(0,j.jsxs)(s.A,{sx:A.ar.content,children:[(0,j.jsxs)(s.A,{sx:A.ar.leftSection,children:[(0,j.jsx)(a.A,{variant:"h4",sx:{...A.ar.title,fontSize:{xs:"1.5rem",customSm:"2rem",md:"2.5rem"}},"aria-label":y.titleAriaLabel||`Title: ${y.title||n.username}`,children:y.title||n.username}),y.description&&(0,j.jsx)(a.A,{variant:"body1",color:"text.secondary",sx:{mt:1,mb:2,fontSize:{xs:"0.875rem",md:"1rem"},lineHeight:1.6},"aria-label":y.descriptionAriaLabel||`Description: ${y.description}`,children:y.description}),"user"===y.type?(0,j.jsxs)(a.A,{variant:"body2",sx:{...A.ar.level,fontSize:{xs:"0.875rem",customSm:"1rem"}},children:["Level: ",(0,j.jsx)(_,{level:n.access_level})]}):"page"===y.type?T:(0,j.jsx)(s.A,{sx:A.ar.chipContainer,children:null===(i=y.chips)||void 0===i?void 0:i.map(((e,i)=>(0,j.jsx)(s.A,{sx:{position:"relative"},children:(0,j.jsx)(h.A,{label:e.label,icon:e.icon,size:"medium",variant:"outlined",color:e.color||"default",onClick:()=>R(i),sx:{...A.ar.chip,...N===i?A.ar.chipExpanded:A.ar.chipCollapsed},"aria-label":e.ariaLabel,"aria-expanded":N===i})},i)))})]}),b&&(q||H||U)&&(0,j.jsx)(s.A,{sx:A.ar.rightSection,children:(0,j.jsx)(s.A,{sx:A.ar.buttonGroup,children:(0,j.jsxs)(j.Fragment,{children:["page"===y.type&&C,V.map(((e,i)=>(0,j.jsx)(w.A,{title:e.tooltip,children:(0,j.jsx)(u.A,{onClick:e.onClick,startIcon:e.icon,sx:{...A.nT,..."delete"===e.variant&&{bgcolor:k.palette.error.main,color:k.palette.common.white,"&:hover":{bgcolor:k.palette.error.dark}}},disabled:e.disabled,"aria-label":e.ariaLabel,children:e.label})},i))),(H||U)&&(0,j.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[H&&(0,j.jsx)(w.A,{title:y.isFavorited?`Remove ${y.type} from favorites`:`Add ${y.type} to favorites`,children:(0,j.jsx)(o.A,{onClick:y.onFavoriteToggle,disabled:y.actionLoading,"aria-label":y.isFavorited?"Remove from favorites":"Add to favorites",sx:{display:{xs:"none",customSm:"inline-flex"}},children:y.isFavorited?(0,j.jsx)(f.A,{color:"warning"}):(0,j.jsx)(p.A,{})})}),U&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.A,{onClick:O,disabled:y.actionLoading,"aria-label":"More actions",children:(0,j.jsx)(m.A,{})}),(0,j.jsx)(g.A,{anchorEl:F,open:I,onClose:L,PaperProps:{sx:{mt:1,boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}},children:M.map(((e,i)=>(0,j.jsx)(x.A,{onClick:()=>B(e.onClick),sx:"delete"===e.variant?{color:k.palette.error.main}:{},children:e.label},i)))})]})]})]})})})]})]})})}))},9483:(e,i,n)=>{n.r(i),n.d(i,{default:()=>L});var t=n(5043),l=n(1675),s=n(7353),a=n(1906),o=n(3560),r=n(3536),d=n.n(r),c=n(2958),u=n(4401),g=n(766),x=n(5721),h=n(681),v=n(8734),f=n(2110),p=n(6494),m=n(4496),A=n(8903),b=n(6552),j=n(579);const y=e=>{let{title:i,children:n}=e;return(0,j.jsx)(f.A,{sx:b.qJ.card,children:(0,j.jsxs)(p.A,{sx:b.qJ.content,children:[(0,j.jsx)(m.A,{variant:"h5",sx:b.qJ.title,children:i}),(0,j.jsx)(A.Ay,{container:!0,spacing:2,children:n})]})})};var E=n(7784),C=n(2143);const _=e=>{let{label:i,value:n,field:t,isEditing:l,onChange:a,select:o=!1,options:r=[],editSx:d={}}=e;return(0,j.jsxs)(s.A,{sx:b.j$.container,children:[(0,j.jsx)(m.A,{variant:"body2",sx:b.j$.label,children:i}),l?o?(0,j.jsx)(E.A,{select:!0,fullWidth:!0,variant:"outlined",size:"small",value:n||"",onChange:a(t),sx:{...b.j$.input,...d},children:r.map((e=>(0,j.jsx)(C.A,{value:e,children:e},e)))}):(0,j.jsx)(E.A,{fullWidth:!0,variant:"outlined",size:"small",value:n||"",onChange:a(t),sx:{...b.j$.input,...d}}):(0,j.jsx)(m.A,{variant:"body2",sx:b.j$.value,children:n||"Not set"})]})};var w=n(4605),S=n(7843);const D=e=>{let{label:i,checked:n,onChange:t,disabled:l=!1}=e;return(0,j.jsx)(w.A,{labelPlacement:"start",sx:b.Dq.formControl,control:(0,j.jsx)(S.A,{checked:n,onChange:t,sx:b.Dq.switch,disabled:l}),label:i})},k=e=>{var i,n,l,a,o,r,d,c,u,f,p,m;let{profileData:A,isOwnProfile:E,pointsHistory:C,isEditing:w,setUserData:S}=e;const k=(0,t.useCallback)(((e,i)=>n=>{const t=n.target.value;S((n=>i?{...n,[e]:{...n[e],[i]:t}}:"onlineStatus"===e||"isPublic"===e?{...n,[e]:"Visible"===t||"Hide"!==t&&"Anonymous"!==t&&t}:"lastSeen"===e?{...n,[e]:"Visible"===t?new Date:null}:{...n,[e]:t}))}),[S]),F=(0,t.useCallback)(((e,i)=>()=>{S((n=>({...n,[e]:{...n[e],notifications:{...n[e].notifications,[i]:!n[e].notifications[i]}}})))}),[S]);return(0,j.jsxs)(s.A,{sx:{...b.iH,display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:2,sm:3},rowGap:{xs:2,sm:0}},children:[(0,j.jsx)(s.A,{sx:{display:"flex"},children:(0,j.jsx)(y,{title:"Personal Info",sx:{flex:1,display:"flex",flexDirection:"column"},children:(0,j.jsxs)(g.A,{container:!0,spacing:{xs:2,sm:3},sx:{flex:1},children:[(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Full Name",value:A.fullName||"",field:"fullName",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Username",value:A.username||"",field:"username",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Email",value:A.email||"",field:"email",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Location",value:A.location||"",field:"location",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Timezone",value:A.timezone||"",field:"timezone",isEditing:w&&E,onChange:k,select:!0,options:["UTC-12:00","UTC+00:00","UTC+14:00"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Ethnicity",value:A.ethnicity||"",field:"ethnicity",isEditing:w&&E,onChange:k,select:!0,options:["Asian","Black","Other"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Gender",value:A.gender||"",field:"gender",isEditing:w&&E,onChange:k,select:!0,options:["Male","Female","Other"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Date of Birth",value:A.dateOfBirth?new Date(A.dateOfBirth).toISOString().split("T")[0]:"",field:"dateOfBirth",isEditing:w&&E,onChange:k,type:"date"})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Contact Number",value:A.phone||"",field:"phone",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Wallet Address",value:A.wallet_address||"",field:"wallet_address",isEditing:w&&E,onChange:k})})]})})}),(0,j.jsx)(s.A,{sx:{display:"flex"},children:(0,j.jsx)(y,{title:"Social Info",sx:{flex:1,display:"flex",flexDirection:"column"},children:(0,j.jsxs)(g.A,{container:!0,spacing:{xs:2,sm:3},sx:{flex:1},children:[(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Language",value:(null===(i=A.preferences)||void 0===i?void 0:i.language)||"",field:"preferences",subfield:"language",isEditing:w&&E,onChange:k,select:!0,options:["en","ua","es"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Public Profile",value:A.isPublic?"Visible":"Anonymous",field:"isPublic",isEditing:w&&E,onChange:k,select:!0,options:["Anonymous","Visible"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Online Status",value:A.onlineStatus?"Visible":"Hide",field:"onlineStatus",isEditing:w&&E,onChange:k,select:!0,options:["Hide","Visible"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Last Seen",value:A.lastSeen?"Visible":"Hide",field:"lastSeen",isEditing:w&&E,onChange:k,select:!0,options:["Hide","Visible"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Name Visibility",value:A.nameVisibility||"",field:"nameVisibility",isEditing:w&&E,onChange:k,select:!0,options:["Public","Friends","Private"]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Twitter",value:(null===(n=A.social_links)||void 0===n?void 0:n.twitter)||"",field:"social_links",subfield:"twitter",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"Instagram",value:(null===(l=A.social_links)||void 0===l?void 0:l.instagram)||"",field:"social_links",subfield:"instagram",isEditing:w&&E,onChange:k})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsx)(_,{label:"LinkedIn",value:(null===(a=A.social_links)||void 0===a?void 0:a.linkedin)||"",field:"social_links",subfield:"linkedin",isEditing:w&&E,onChange:k})})]})})}),(0,j.jsx)(s.A,{sx:{gridColumn:{xs:"1",sm:"2"},display:"flex"},children:(0,j.jsx)(y,{title:"Notifications & Preferences",sx:{flex:1,display:"flex",flexDirection:"column"},children:(0,j.jsxs)(g.A,{container:!0,spacing:{xs:2,sm:3},sx:{flex:1},children:[(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsxs)(g.A,{container:!0,spacing:{xs:2,sm:4},children:[(0,j.jsx)(g.A,{size:12,children:(0,j.jsx)(D,{label:"Email",checked:(null===(o=A.preferences)||void 0===o||null===(r=o.notifications)||void 0===r?void 0:r.email)||!1,onChange:F("preferences","email"),disabled:!w||!E})}),(0,j.jsx)(g.A,{size:12,children:(0,j.jsx)(D,{label:"SMS",checked:(null===(d=A.preferences)||void 0===d||null===(c=d.notifications)||void 0===c?void 0:c.sms)||!1,onChange:F("preferences","sms"),disabled:!w||!E})}),(0,j.jsx)(g.A,{size:12,children:(0,j.jsx)(D,{label:"Push",checked:(null===(u=A.preferences)||void 0===u||null===(f=u.notifications)||void 0===f?void 0:f.push)||!1,onChange:F("preferences","push"),disabled:!w||!E})})]})}),(0,j.jsx)(g.A,{size:{xs:12,sm:6},children:(0,j.jsxs)(g.A,{container:!0,spacing:{xs:2,sm:3},children:[(0,j.jsx)(g.A,{size:12,children:(0,j.jsx)(_,{label:"Theme",value:(null===(p=A.preferences)||void 0===p?void 0:p.theme)||"",field:"preferences",subfield:"theme",isEditing:w&&E,onChange:k,select:!0,options:["Light","Dark","System"]})}),(0,j.jsx)(g.A,{size:12,children:(0,j.jsx)(_,{label:"Content Language",value:(null===(m=A.preferences)||void 0===m?void 0:m.contentLanguage)||"",field:"preferences",subfield:"contentLanguage",isEditing:w&&E,onChange:k,select:!0,options:["en","ua","es"]})})]})})]})})}),E&&(null===C||void 0===C?void 0:C.length)>0&&(0,j.jsx)(s.A,{sx:{gridColumn:"1 / -1",display:"flex"},children:(0,j.jsx)(y,{title:"Points History",sx:{flex:1,display:"flex",flexDirection:"column"},children:(0,j.jsx)(s.A,{sx:{flex:1,overflowY:"auto"},children:(0,j.jsx)(x.A,{children:C.map(((e,i)=>(0,j.jsx)(h.Ay,{children:(0,j.jsx)(v.A,{primary:`Points: ${e.points}`,secondary:`Action: ${e.action} | Date: ${new Date(e.timestamp).toLocaleDateString()}`})},i)))})})})})]})};var F=n(3769),P=n(342),N=n(9472);const z="/api/v1/profile",I=(e,i,n,l,s)=>{const[a,o]=(0,t.useState)(null),[r,d]=(0,t.useState)(!1),[c,u]=(0,t.useState)([]),[g,x]=(0,t.useState)(!1),[h,v]=(0,t.useState)(null),f=(0,t.useCallback)((e=>{if(401===e.status||403===e.status)throw n("Your session has expired. Please log in again."),l("/login"),new Error("Session expired");throw e}),[n,l]),p=(0,t.useCallback)((()=>{o(null),d(!1),u([]),v(null),x(!1)}),[]),m=(0,t.useCallback)((async(n,t)=>{if(!e||null===i||void 0===i||!i.anonymous_id)throw new Error("Authentication required");if(!n)throw new Error("Profile ID is required");x(!0);try{var l,r;const c=await(async(e,i,n)=>{if(!e||"string"!==typeof e||!e.trim())throw new Error("Profile ID is required");if(!i||"string"!==typeof i||!i.trim())throw new Error("Token is required");try{return(await(0,N.Jt)(`${z}/${e}`,{headers:{Authorization:`Bearer ${i}`},signal:n instanceof AbortSignal?n:void 0})).data.content||{}}catch(h){throw(0,N.hS)(h)}})(n,e,t),u=a||i;c.total_points=Number(c.total_points)>=0?Number(c.total_points):null!==(l=null===u||void 0===u?void 0:u.total_points)&&void 0!==l?l:0,c.donated_points=Number(c.donated_points)>=0?Number(c.donated_points):null!==(r=null===u||void 0===u?void 0:u.donated_points)&&void 0!==r?r:0;const g=n===i.anonymous_id;return o(c),d(g),g&&JSON.stringify(c)!==JSON.stringify(i)&&s(c),{profileData:c,isOwnProfile:g}}catch(c){return"AbortError"!==c.name&&(v(c.message||"Failed to fetch profile"),f(c)),null}finally{x(!1)}}),[e,i,s,f,a]),A=(0,t.useCallback)((async(n,t)=>{if(!e)throw new Error("Token missing");x(!0);try{var l,d;const c=await(async(e,i,n)=>{if(!e||"object"!==typeof e||0===Object.keys(e).length)throw new Error("Profile data is required");if(!i||"string"!==typeof i||!i.trim())throw new Error("Token is required");try{return(await(0,N.yJ)(`${z}/update`,e,{headers:{Authorization:`Bearer ${i}`},signal:n instanceof AbortSignal?n:void 0})).data.content||{}}catch(h){throw(0,N.hS)(h)}})(n,e,t),u=a||i,g={...a,...c,total_points:Number(c.total_points)>=0?Number(c.total_points):null!==(l=null===u||void 0===u?void 0:u.total_points)&&void 0!==l?l:0,donated_points:Number(c.donated_points)>=0?Number(c.donated_points):null!==(d=null===u||void 0===u?void 0:u.donated_points)&&void 0!==d?d:0};return o(g),r&&s(g),g}catch(c){if("AbortError"!==c.name)throw v(c.message||"Failed to update profile"),c;return null}finally{x(!1)}}),[e,r,s,a,i]),b=(0,t.useCallback)((async i=>{if(!e)throw new Error("Authentication required");x(!0);try{await(async(e,i)=>{if(!e||"string"!==typeof e||!e.trim())throw new Error("Token is required");try{return(await(0,N.yH)(`${z}/delete`,{headers:{Authorization:`Bearer ${e}`},signal:i instanceof AbortSignal?i:void 0})).data.content||{}}catch(h){throw(0,N.hS)(h)}})(e,i),p(),n("Your profile has been deleted."),l("/")}catch(t){"AbortError"!==t.name&&(v(t.message||"Failed to delete profile"),f(t))}finally{x(!1)}}),[e,n,l,p,f]),j=(0,t.useCallback)((async i=>{if(!e)throw new Error("Authentication required");x(!0);try{const n=await(async(e,i)=>{if(!e||"string"!==typeof e||!e.trim())throw new Error("Token is required");try{var n;return(null===(n=(await(0,N.Jt)(`${z}/points/history`,{headers:{Authorization:`Bearer ${e}`},signal:i instanceof AbortSignal?i:void 0})).data.content)||void 0===n?void 0:n.history)||[]}catch(h){throw(0,N.hS)(h)}})(e,i);return u(n),n}catch(n){return"AbortError"!==n.name&&(v(n.message||"Failed to fetch points history"),f(n)),[]}finally{x(!1)}}),[e,f]);return(0,t.useMemo)((()=>({profileData:a,isOwnProfile:r,pointsHistory:c,loading:g,error:h,fetchProfileData:m,updateProfileData:A,deleteProfileData:b,fetchProfilePointsHistory:j,clearProfileState:p})),[a,r,c,g,h,m,A,b,j,p])},T=function(e){var i,n,t,l,s,a,o,r,d,c,u,g,x,h,v,f,p,m,A,b,j,y,E,C,_,w,S,D,k,F,P,N,z,I,T,O,L,B,R,$;let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?{anonymous_id:e.anonymous_id||"",username:e.username||"Someone",email:e.email||"",total_points:Number(e.total_points)>=0?Number(e.total_points):null!==(i=null===M||void 0===M?void 0:M.total_points)&&void 0!==i?i:0,donated_points:Number(e.donated_points)>=0?Number(e.donated_points):null!==(n=null===M||void 0===M?void 0:M.donated_points)&&void 0!==n?n:0,profile_picture:e.profile_picture||"",bio:e.bio||"",social_links:{twitter:(null===(t=e.social_links)||void 0===t?void 0:t.twitter)||"",instagram:(null===(l=e.social_links)||void 0===l?void 0:l.instagram)||"",linkedin:(null===(s=e.social_links)||void 0===s?void 0:s.linkedin)||""},isPublic:null===(a=e.isPublic)||void 0===a||a,isActive:null===(o=e.isActive)||void 0===o||o,timezone:e.timezone||"",gender:e.gender||"",location:e.location||"",ethnicity:e.ethnicity||"",dateOfBirth:e.dateOfBirth||null,onlineStatus:e.onlineStatus||"offline",lastSeen:e.lastSeen||null,nameVisibility:e.nameVisibility||"public",preferences:{language:(null===(r=e.preferences)||void 0===r?void 0:r.language)||"en",theme:(null===(d=e.preferences)||void 0===d?void 0:d.theme)||"System",contentLanguage:(null===(c=e.preferences)||void 0===c?void 0:c.contentLanguage)||"en",notifications:{email:null!==(u=null===(g=e.preferences)||void 0===g||null===(x=g.notifications)||void 0===x?void 0:x.email)&&void 0!==u&&u,sms:null!==(h=null===(v=e.preferences)||void 0===v||null===(f=v.notifications)||void 0===f?void 0:f.sms)&&void 0!==h&&h,push:null!==(p=null===(m=e.preferences)||void 0===m||null===(A=m.notifications)||void 0===A?void 0:A.push)&&void 0!==p&&p},favorite_boards:(null===(b=e.preferences)||void 0===b?void 0:b.favorite_boards)||[],muted_boards:(null===(j=e.preferences)||void 0===j?void 0:j.muted_boards)||[],content_filters:{show_public_only:null!==(y=null===(E=e.preferences)||void 0===E||null===(C=E.content_filters)||void 0===C?void 0:C.show_public_only)&&void 0!==y&&y,hide_anonymous:null!==(_=null===(w=e.preferences)||void 0===w||null===(S=w.content_filters)||void 0===S?void 0:S.hide_anonymous)&&void 0!==_&&_,preferred_tags:(null===(D=e.preferences)||void 0===D||null===(k=D.content_filters)||void 0===k?void 0:k.preferred_tags)||[]}},access_level:e.access_level||"user",stats:{tweet_count:(null===(F=e.stats)||void 0===F?void 0:F.tweet_count)||0,board_count:(null===(P=e.stats)||void 0===P?void 0:P.board_count)||0,gate_count:(null===(N=e.stats)||void 0===N?void 0:N.gate_count)||0,class_count:(null===(z=e.stats)||void 0===z?void 0:z.class_count)||0,like_count:(null===(I=e.stats)||void 0===I?void 0:I.like_count)||0,points_earned:(null===(T=e.stats)||void 0===T?void 0:T.points_earned)||0,points_spent:(null===(O=e.stats)||void 0===O?void 0:O.points_spent)||0},created_content:{tweets:(null===(L=e.created_content)||void 0===L?void 0:L.tweets)||[],boards:(null===(B=e.created_content)||void 0===B?void 0:B.boards)||[],gates:(null===(R=e.created_content)||void 0===R?void 0:R.gates)||[],classes:(null===($=e.created_content)||void 0===$?void 0:$.classes)||[]},friends:e.friends||[],gate:e.gate||null,created_at:e.created_at||(new Date).toISOString(),updated_at:e.updated_at||(new Date).toISOString(),last_synced_at:e.last_synced_at||(new Date).toISOString()}:null};var O=n(1654);const L=()=>{const e=(0,l.Zp)(),{anonymous_id:i}=(0,l.g)(),{token:n,authData:r,isAuthenticated:g,handleLogout:x,updateAuthData:h,loading:v}=(0,P.A)(e),{profileData:f,pointsHistory:p,loading:m,fetchProfileData:A,fetchProfilePointsHistory:y,updateProfileData:E,clearProfileState:C}=I(n,r,x,e,h),{showNotification:_}=(0,O.hN)(),[w,S]=(0,t.useState)(!1),[D,N]=(0,t.useState)((()=>T(r||f,r))),z=(0,t.useMemo)((()=>i===(null===r||void 0===r?void 0:r.anonymous_id)),[i,r]);(0,t.useEffect)((()=>{if(v)return;if(!g||!r||!n)return C(),_("Please log in to view your profile.","error"),void e("/login");if(!i)return x("Anonymous ID is missing. Please log in again."),_("Anonymous ID is missing.","error"),void e("/login");const t=new AbortController,l=t.signal;return(async()=>{try{const n=[];z||n.push(A(i,l)),z&&n.push(y(l)),await Promise.all(n);const t=T(z?r:f,r);if(!t)return _("Profile not found. Please try again or check the profile ID.","error"),void e("/not-found",{state:{message:`Profile with ID ${i} not found.`}});N(t)}catch(n){"AbortError"!==n.name&&(console.error("Error loading profile data in ProfilePage:",n),_(n.message||"Failed to load profile data","error"),"Profile not found"===n.message&&e("/not-found",{state:{message:`Profile with ID ${i} not found.`}}))}})(),()=>t.abort()}),[i,r,n,g,v,z,e,A,y,x,C,f,_]);const L=(0,t.useCallback)((async()=>{const e=((e,i)=>{const n={},t=["total_points","donated_points"];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&!t.includes(l)&&(d().isEqual(e[l],i[l])||(n[l]=i[l]));return n})(T(r),D);if(0===Object.keys(e).length)return _("No changes to save.","info"),void S(!1);try{const i=await E(e);if(!i)throw new Error("Failed to update profile");{const e=T(i,r);N(e),h(e),_("Profile updated successfully!","success"),S(!1)}}catch(i){_(i.message||"Failed to update profile","error")}}),[D,r,E,h,_]);return v||!z&&m?(0,j.jsx)(u.A,{}):D?(0,j.jsx)(c.A,{currentUser:r,onLogout:x,token:n,children:(0,j.jsxs)(s.A,{sx:{...b.iH},children:[(0,j.jsx)(F.A,{user:D,isOwnProfile:z,children:z&&(0,j.jsx)(s.A,{sx:{...b.ar.buttonGroup},children:w?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.A,{variant:"contained",onClick:L,sx:{...b.nT},"aria-label":"Save profile",children:"Save"}),(0,j.jsx)(a.A,{variant:"contained",onClick:()=>{N(T(r)),S(!1)},sx:{...b.Km},"aria-label":"Cancel editing",children:"Cancel"})]}):(0,j.jsx)(a.A,{variant:"contained",onClick:()=>{S(!0)},startIcon:(0,j.jsx)(o.A,{}),sx:{...b.nT},"aria-label":"Edit profile",children:"Edit Profile"})})}),(0,j.jsx)(k,{profileData:D,isOwnProfile:z,pointsHistory:p,isEditing:w,setUserData:N})]})}):null}}}]);
//# sourceMappingURL=483.b59d91be.chunk.js.map